
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Amazon API Gateway traits &#8212; Smithy 1.0 documentation</title><link rel="stylesheet" href="../../../_static/bootstrap-reboot.css" type="text/css" />
    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" href="../../../_static/custom-tabs.css" type="text/css" />

    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script type="text/javascript" src="../../../_static/smithy.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="AWS CloudFormation traits" href="aws-cloudformation.html" />
    <link rel="prev" title="AWS IAM traits" href="aws-iam.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="smithy-version" content="1.0">

  </head><body>
    <header>
        <div class="header-flex width-wrapper">
            <div class="site-logo">
                <a href="../../../index.html">
                    <span class="logo-icon">üî®Ô∏è</span><span class="logo-text">Smithy</span>
                </a>
                <span class="version-text">1.0</span>
            </div>
            <ul id="page-navigation">
                <li class="site-page first"><a href="../../../quickstart.html">Quick Start</a></li>
                <li class="site-page"><a href="../index.html">Specifications</a></li>
                <li class="site-page"><a href="../../guides/index.html">Guides</a></li>
                <li class="site-page"><a href="https://github.com/awslabs/smithy">Code</a></li>
                <li class="site-search hidden-sm">
                    <form action="../../../search.html" method="get">
                        <input type="hidden" name="check_keywords" value="yes" />
                        <input type="hidden" name="area" value="default" />
                        <input class="search-input" autocomplete="off" type="search" name="q" placeholder="Search" />
                    </form>
                </li>
            </ul>
        </div>
    </header>
    
        
        
        <section id="page-container">
            <div class="width-wrapper flex">
                <article class="document-body">
                    
                    <ul class="rel-parents">
                    <li><a href="../index.html" >Specifications</a></li>
                    <li><a href="index.html" accesskey="U">AWS specifications</a></li>
                    </ul>
                    
                    
  <div class="section" id="amazon-api-gateway-traits">
<h1><a href="#amazon-api-gateway-traits">Amazon API Gateway traits</a></h1>
<p>Smithy can integrate with Amazon API Gateway using traits, authentication
schemes, and OpenAPI specifications.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#aws-apigateway-apikeysource-trait" id="id7"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#apiKeySource</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-authorizers-trait" id="id8"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizers</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-authorizer-trait" id="id9"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizer</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-requestvalidator-trait" id="id10"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#requestValidator</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-integration-trait" id="id11"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#integration</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-mockintegration-trait" id="id12"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#mockIntegration</span></code> trait</a></li>
<li><a class="reference internal" href="#shared-trait-data-types" id="id13">Shared trait data types</a></li>
</ul>
</div>
<div class="section" id="aws-apigateway-apikeysource-trait">
<span id="aws-apigateway-apikeysource-trait"></span><span id="id1"></span><h2><a href="#aws-apigateway-apikeysource-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#apiKeySource</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Specifies the source of the caller identifier that will be used to
throttle API methods that require a key.</dd>
<dt>Trait selector</dt><dd><code class="docutils literal notranslate"><span class="pre">service</span></code></dd>
<dt>Value type</dt><dd><p><code class="docutils literal notranslate"><span class="pre">string</span></code> set to one of the following values:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>HEADER</td>
<td>for receiving the API key from the X-API-Key header of a request</td>
</tr>
<tr class="row-odd"><td>AUTHORIZER</td>
<td>for receiving the API key from the UsageIdentifierKey
from a Lambda authorizer (formerly known as a custom authorizer)</td>
</tr>
</tbody>
</table>
</dd>
<dt>See also</dt><dd><ul class="simple">
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-usage-plans.html">Create and Use Usage Plans with API Keys</a> for more on usage plans and
API keys</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-key-source.html">Choose an API Key Source</a> for information on choosing a source</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-api-key-source.html">x-amazon-apigateway-api-key-source</a> for how this relates to OpenAPI</li>
</ul>
</dd>
</dl>
<p>The following example sets the <code class="docutils literal notranslate"><span class="pre">X-API-Key</span></code> header as the API key source.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-U21pdGh5" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U21pdGh5" name="U21pdGh5" role="tab" tabindex="0">Smithy</button><button aria-controls="panel-0-SlNPTg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-SlNPTg==" name="SlNPTg==" role="tab" tabindex="-1">JSON</button></div><div aria-labelledby="tab-0-U21pdGh5" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-U21pdGh5" name="U21pdGh5" role="tabpanel" tabindex="0"><div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="kd">use</span><span class="nc"> aws.apigateway#apiKeySource</span><span class="w"></span>

<span class="nd">@apiKeySource</span>(<span class="s2">&quot;HEADER&quot;</span>)<span class="w"></span>
<span class="kd">service</span><span class="nc"> Weather</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;2018-03-17&quot;</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-SlNPTg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-SlNPTg==" name="SlNPTg==" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;smithy.example#Weather&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
            <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-03-17&quot;</span><span class="p">,</span>
            <span class="nt">&quot;traits&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;aws.apigateway#apiKeySource&quot;</span><span class="p">:</span> <span class="s2">&quot;HEADER&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-authorizers-trait">
<span id="aws-apigateway-authorizers-trait"></span><span id="id2"></span><h2><a href="#aws-apigateway-authorizers-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizers</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-authorizer.html">Lambda authorizers</a> to attach to the authentication schemes defined on
this service.</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">service[trait|protocols]</span></code></p>
<p><em>A service shape that has the protocols trait</em></p>
</dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">map</span></code> of arbitrary names to <em>authorizer</em> definitions. These authorizer
definitions are applied to a service, resource, or operation using the
<a class="reference internal" href="#aws-apigateway-authorizer-trait"><span class="std std-ref">aws.apigateway#authorizer trait</span></a>.</dd>
</dl>
<p>An <em>authorizer</em> definition is a structure that supports the following members:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>scheme</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required</strong>. A Smithy authentication scheme shape ID that identifies
how a client authenticates. This value MUST reference one of the
<a class="reference internal" href="../core/auth-traits.html#authdefinition-trait"><span class="std std-ref">authentication schemes</span></a> attached to the
service.</td>
</tr>
<tr class="row-odd"><td>type</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The type of the authorizer. If specifying information beyond the
scheme or customAuthType, this value is required. The value must be
&quot;token&quot;, for an authorizer with the caller identity embedded in an
authorization token, or &quot;request&quot;, for an authorizer with the caller
identity contained in request parameters.</td>
</tr>
<tr class="row-even"><td>customAuthType</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The <code class="docutils literal notranslate"><span class="pre">authType</span></code> of the authorizer. This value is used in APIGateway
exports as <code class="docutils literal notranslate"><span class="pre">x-amazon-apigateway-authtype</span></code>. This value is set to
<code class="docutils literal notranslate"><span class="pre">custom</span></code> by default if <code class="docutils literal notranslate"><span class="pre">type</span></code> is set, or <code class="docutils literal notranslate"><span class="pre">awsSigv4</span></code> if your
scheme is <a class="reference internal" href="aws-auth.html#aws-auth-sigv4-trait"><span class="std std-ref">aws.auth#sigv4</span></a>.</td>
</tr>
<tr class="row-odd"><td>uri</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies the authorizer's Uniform Resource Identifier
(URI). For <code class="docutils literal notranslate"><span class="pre">token</span></code> or <code class="docutils literal notranslate"><span class="pre">request</span></code> authorizers, this must be a
well-formed Lambda function URI, for example,
<code class="docutils literal notranslate"><span class="pre">arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:{account_id}:function:{lambda_function_name}/invocations</span></code>.
In general, the URI has this form <code class="docutils literal notranslate"><span class="pre">arn:aws:apigateway:{region}:lambda:path/{service_api}</span></code>,
where <code class="docutils literal notranslate"><span class="pre">{region}</span></code> is the same as the region hosting the Lambda
function, path indicates that the remaining substring in the URI
should be treated as the path to the resource, including the initial
<code class="docutils literal notranslate"><span class="pre">/</span></code>. For Lambda functions, this is usually of the form
<code class="docutils literal notranslate"><span class="pre">/2015-03-31/functions/[FunctionARN]/invocations</span></code>.</td>
</tr>
<tr class="row-even"><td>credentials</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies the required credentials as an IAM role for API Gateway to
invoke the authorizer. To specify an IAM role for API Gateway to
assume, use the role's Amazon Resource Name (ARN). This value MUST
be omitted in order to use resource-based permissions on the
Lambda function.</td>
</tr>
<tr class="row-odd"><td>identitySource</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><p class="first">The identity source for which authorization is requested.</p>
<p>For a <code class="docutils literal notranslate"><span class="pre">token</span></code> or <code class="docutils literal notranslate"><span class="pre">cognito_user_pools</span></code> authorizer, this is required
and specifies the request header mapping expression for the custom
header holding the authorization token submitted by the client. For
example, if the token header name is Auth, the header mapping
expression is <code class="docutils literal notranslate"><span class="pre">method.request.header.Auth</span></code>.</p>
<p class="last">For the <code class="docutils literal notranslate"><span class="pre">request</span></code> authorizer, this is required when authorization
caching is enabled. The value is a comma-separated string of one or
more mapping expressions of the specified request parameters. For
example, if an Auth header and a Name query string parameter are
defined as identity sources, this value is <code class="docutils literal notranslate"><span class="pre">method.request.header.Auth,</span> <span class="pre">method.request.querystring.Name</span></code>.
These parameters will be used to derive the authorization caching
key and to perform runtime validation of the <code class="docutils literal notranslate"><span class="pre">request</span></code> authorizer
by verifying all of the identity-related request parameters are
present, not null and non-empty. Only when this is true does the
authorizer invoke the authorizer Lambda function, otherwise, it
returns a 401 Unauthorized response without calling the Lambda
function. The valid value is a string of comma-separated mapping
expressions of the specified request parameters. When the
authorization caching is not enabled, this property is optional.</p>
</td>
</tr>
<tr class="row-even"><td>identityValidationExpression</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>A validation expression for the incoming identity token. For <code class="docutils literal notranslate"><span class="pre">token</span></code>
authorizers, this value is a regular expression. API Gateway will
match the aud field of the incoming token from the client against
the specified regular expression. It will invoke the authorizer's
Lambda function when there is a match. Otherwise, it will return a
401 Unauthorized response without calling the Lambda function. The
validation expression does not apply to the <code class="docutils literal notranslate"><span class="pre">request</span></code> authorizer.</td>
</tr>
<tr class="row-odd"><td>resultTtlInSeconds</td>
<td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>The TTL in seconds of cached authorizer results. If it equals 0,
authorization caching is disabled. If it is greater than 0,
API Gateway will cache authorizer responses. If this field is not set,
the default value is 300. The maximum value is 3600, or 1 hour.</td>
</tr>
</tbody>
</table>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-U21pdGh5" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U21pdGh5" name="U21pdGh5" role="tab" tabindex="0">Smithy</button></div><div aria-labelledby="tab-1-U21pdGh5" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-U21pdGh5" name="U21pdGh5" role="tabpanel" tabindex="0"><div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> ns.foo</span><span class="w"></span>

<span class="kd">use</span><span class="nc"> aws.apigateway#authorizer</span><span class="w"></span>
<span class="kd">use</span><span class="nc"> aws.apigateway#authorizers</span><span class="w"></span>
<span class="kd">use</span><span class="nc"> aws.auth#sigv4</span><span class="w"></span>
<span class="kd">use</span><span class="nc"> aws.protocols#restJson1</span><span class="w"></span>

<span class="nd">@restJson1</span><span class="w"></span>
<span class="nd">@sigv4</span>(<span class="nl">name:</span><span class="w"> </span><span class="s2">&quot;weather&quot;</span>)<span class="w"></span>
<span class="nd">@authorizer</span>(<span class="s2">&quot;arbitrary-name&quot;</span>)<span class="w"></span>
<span class="nd">@authorizers</span>(<span class="w"></span>
<span class="w">    </span><span class="s2">&quot;arbitrary-name&quot;</span><span class="p">:</span><span class="w"> </span>{<span class="w"></span>
<span class="w">        </span><span class="nl">scheme:</span><span class="w"> </span><span class="vc">sigv4</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nl">type:</span><span class="w"> </span><span class="s2">&quot;request&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;arn:foo:baz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nl">credentials:</span><span class="w"> </span><span class="s2">&quot;arn:foo:bar&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nl">identitySource:</span><span class="w"> </span><span class="s2">&quot;mapping.expression&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nl">identityValidationExpression:</span><span class="w"> </span><span class="s2">&quot;[A-Z]+&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nl">resultTtlInSeconds:</span><span class="w"> </span><span class="m">100</span><span class="w"></span>
<span class="w">    </span>})<span class="w"></span>
<span class="kd">service</span><span class="nc"> Weather</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;2018-03-17&quot;</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-authorizer-trait">
<span id="aws-apigateway-authorizer-trait"></span><span id="id3"></span><h2><a href="#aws-apigateway-authorizer-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizer</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Applies a Lambda authorizer to a service, resource, or operation.
Authorizers are resolved hierarchically: an operation inherits
the effective authorizer applied to a parent resource or operation.</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">:is(service,</span> <span class="pre">resource,</span> <span class="pre">operation)</span></code></p>
<p><em>A service, resource, or operation</em></p>
</dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">string</span></code> value that MUST reference one of the keys in the
<a class="reference internal" href="#aws-apigateway-authorizers-trait"><span class="std std-ref">aws.apigateway#authorizers trait</span></a> of the service that contains
the shape.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-requestvalidator-trait">
<span id="aws-apigateway-requestvalidator-trait"></span><span id="id4"></span><h2><a href="#aws-apigateway-requestvalidator-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#requestValidator</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Opts-in to Amazon API Gateway request validation for a service or
operation.</dd>
<dt>Trait selector</dt><dd><code class="docutils literal notranslate"><span class="pre">:test(service,</span> <span class="pre">operation)</span></code></dd>
<dt>Value type</dt><dd><p><code class="docutils literal notranslate"><span class="pre">string</span></code> value set to one of the following:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">full</span></code></td>
<td>The parameters and body of a request are validated.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">params-only</span></code></td>
<td>Only the parameters of a request are validated.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">body-only</span></code></td>
<td>Only the body of a request is validated.</td>
</tr>
</tbody>
</table>
</dd>
<dt>See also</dt><dd><ul class="simple">
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-method-request-validation.html">Enable Request Validation in API Gateway</a> for more information</li>
<li><a class="reference internal" href="../../guides/converting-to-openapi.html#apigateway-request-validators"><span class="std std-ref">Request validators</span></a> for information on how this converts
to OpenAPI</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-request-validators.requestValidator.html">x-amazon-apigateway-request-validator</a> for more on how this converts
to OpenAPI</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-request-validators.html">x-amazon-apigateway-request-validators</a> for more on how this converts
to OpenAPI</li>
</ul>
</dd>
</dl>
<p>Then following example enables request validation on a service:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-U21pdGh5" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U21pdGh5" name="U21pdGh5" role="tab" tabindex="0">Smithy</button><button aria-controls="panel-2-SlNPTg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SlNPTg==" name="SlNPTg==" role="tab" tabindex="-1">JSON</button></div><div aria-labelledby="tab-2-U21pdGh5" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-U21pdGh5" name="U21pdGh5" role="tabpanel" tabindex="0"><div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="kd">use</span><span class="nc"> aws.apigateway#requestValidator</span><span class="w"></span>

<span class="nd">@requestValidator</span>(<span class="s2">&quot;full&quot;</span>)<span class="w"></span>
<span class="kd">service</span><span class="nc"> Weather</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;2018-03-17&quot;</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-SlNPTg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-SlNPTg==" name="SlNPTg==" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;smithy.example#Weather&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
            <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-03-17&quot;</span><span class="p">,</span>
            <span class="nt">&quot;traits&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;aws.apigateway#requestValidator&quot;</span><span class="p">:</span> <span class="s2">&quot;full&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-integration-trait">
<span id="aws-apigateway-integration-trait"></span><span id="id5"></span><h2><a href="#aws-apigateway-integration-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#integration</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Defines an <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/">API Gateway integration</a> that integrates with an actual
backend.</dd>
<dt>Trait selector</dt><dd><code class="docutils literal notranslate"><span class="pre">:test(service,</span> <span class="pre">resource,</span> <span class="pre">operation)</span></code></dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">structure</span></code></dd>
<dt>See also</dt><dd><ul class="simple">
<li><a class="reference internal" href="../../guides/converting-to-openapi.html#apigateway-integrations"><span class="std std-ref">Integrations</span></a> for information on how this converts
to OpenAPI</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/">API Gateway Integration</a> for in-depth API documentation</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-integration.html">x-amazon-apigateway-integration</a> for details on how this looks
to OpenAPI</li>
</ul>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">aws.apigateway#integration</span></code> trait is a structure that supports the
following members:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>type</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><p class="first"><strong>Required.</strong> The type of integration with the specified backend.
Valid values are:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">http</span></code> or <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code>: for integration with an HTTP backend</li>
<li><code class="docutils literal notranslate"><span class="pre">aws_proxy</span></code>: for integration with AWS Lambda functions</li>
<li><code class="docutils literal notranslate"><span class="pre">aws</span></code>: for integration with AWS Lambda functions or other AWS
services such as Amazon DynamoDB, Amazon Simple Notification Service
or Amazon Simple Queue Service.</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>uri</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required.</strong> The endpoint URI of the backend. For integrations of
the <code class="docutils literal notranslate"><span class="pre">aws</span></code> type, this is an ARN value. For the HTTP integration,
this is the URL of the HTTP endpoint including the <code class="docutils literal notranslate"><span class="pre">https</span></code> or
<code class="docutils literal notranslate"><span class="pre">http</span></code> scheme.</td>
</tr>
<tr class="row-even"><td>httpMethod</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required.</strong> Specifies the integration's HTTP method type
(for example, <code class="docutils literal notranslate"><span class="pre">POST</span></code>). For Lambda function invocations, the value
must be <code class="docutils literal notranslate"><span class="pre">POST</span></code>.</td>
</tr>
<tr class="row-odd"><td>credentials</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies the credentials required for the integration, if any. For
AWS IAM role-based credentials, specify the ARN of an appropriate
IAM role. If unspecified, credentials will default to resource-based
permissions that must be added manually to allow the API to access
the resource. For more information, see
<a class="reference external" href="https://docs.aws.amazon.com/lambda/latest/dg/intro-permission-model.html#intro-permission-model-access-policy">Granting Permissions Using a Resource Policy</a>.</td>
</tr>
<tr class="row-even"><td>passThroughBehavior</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies how a request payload of unmapped content type is passed
through the integration request without modification. Supported
values are <code class="docutils literal notranslate"><span class="pre">when_no_templates</span></code>, <code class="docutils literal notranslate"><span class="pre">when_no_match</span></code>, and <code class="docutils literal notranslate"><span class="pre">never</span></code>.
For more information, see <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/#passthroughBehavior">Integration.passthroughBehavior</a>.</td>
</tr>
<tr class="row-odd"><td>contentHandling</td>
<td><a class="reference internal" href="#apigateway-content-handling"><span class="std std-ref">ContentHandling string</span></a></td>
<td>Request payload content handling.</td>
</tr>
<tr class="row-even"><td>timeoutInMillis</td>
<td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>Integration timeouts between 50 ms and 29,000 ms.</td>
</tr>
<tr class="row-odd"><td>connectionId</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The ID of a <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/vpc-link/">VpcLink</a> for the private integration.</td>
</tr>
<tr class="row-even"><td>connectionType</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The type of the network connection to the integration endpoint.
The valid value is <code class="docutils literal notranslate"><span class="pre">INTERNET</span></code> for connections through the public
routable internet or <code class="docutils literal notranslate"><span class="pre">VPC_LINK</span></code> for private connections between
API Gateway and a network load balancer in a VPC. The default
value is <code class="docutils literal notranslate"><span class="pre">INTERNET</span></code>.</td>
</tr>
<tr class="row-odd"><td>cacheNamespace</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>An API-specific tag group of related cached parameters.</td>
</tr>
<tr class="row-even"><td>payloadFormatVersion</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies the format of the payload sent to an integration. Required for HTTP APIs. For HTTP APIs,
supported values for Lambda proxy integrations are 1.0 and 2.0. For all other integrations, 1.0 is the
only supported value.</td>
</tr>
<tr class="row-odd"><td>cacheKeyParameters</td>
<td><code class="docutils literal notranslate"><span class="pre">list&lt;string&gt;</span></code></td>
<td>A list of request parameter names whose values are to be cached.</td>
</tr>
<tr class="row-even"><td>requestParameters</td>
<td><code class="docutils literal notranslate"><span class="pre">map</span></code> of <a class="reference internal" href="#apigateway-requestparameters"><span class="std std-ref">requestParameters structure</span></a> to request parameters</td>
<td>Specifies mappings from method request parameters to integration
request parameters. Supported request parameters are querystring,
path, header, and body.</td>
</tr>
<tr class="row-odd"><td>requestTemplates</td>
<td><code class="docutils literal notranslate"><span class="pre">map</span></code> of media types to <a class="reference internal" href="#apigateway-requesttemplates"><span class="std std-ref">requestTemplates structure</span></a></td>
<td>Mapping templates for a request payload of specified media types.</td>
</tr>
<tr class="row-even"><td>responses</td>
<td><code class="docutils literal notranslate"><span class="pre">map</span></code> of response codes to <a class="reference internal" href="#apigateway-responses"><span class="std std-ref">responses structure</span></a></td>
<td>Defines the method's responses and specifies desired parameter
mappings or payload mappings from integration responses to method
responses.</td>
</tr>
</tbody>
</table>
<p>The following example defines an integration that is applied to every
operation within the service.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;smithy.example#Weather&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
            <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-03-17&quot;</span><span class="p">,</span>
            <span class="nt">&quot;traits&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;aws.protocols#restJson1&quot;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="nt">&quot;aws.auth#sigv4&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;weather&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;aws.apigateway#integration&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;aws&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:012345678901:function:HelloWorld/invocations&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;httpMethod&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;credentials&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:iam::012345678901:role/apigateway-invoke-lambda-exec-role&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;requestTemplates&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;application/json&quot;</span><span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;application/xml&quot;</span><span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;requestParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;integration.request.path.stage&quot;</span><span class="p">:</span> <span class="s2">&quot;method.request.querystring.version&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;integration.request.querystring.provider&quot;</span><span class="p">:</span> <span class="s2">&quot;method.request.querystring.vendor&quot;</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;cacheNamespace&quot;</span><span class="p">:</span> <span class="s2">&quot;cache namespace&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;cacheKeyParameters&quot;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="nt">&quot;responses&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;2\\d{2}&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span><span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.requestId&quot;</span><span class="p">:</span> <span class="s2">&quot;integration.response.header.cid&quot;</span>
                            <span class="p">},</span>
                            <span class="nt">&quot;responseTemplates&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;application/json&quot;</span><span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                                <span class="nt">&quot;application/xml&quot;</span><span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;302&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span><span class="p">:</span> <span class="s2">&quot;302&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.Location&quot;</span><span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span><span class="p">:</span> <span class="s2">&quot;400&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.test-method-response-header&quot;</span><span class="p">:</span> <span class="s2">&quot;&#39;static value&#39;&quot;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-mockintegration-trait">
<span id="aws-apigateway-mockintegration-trait"></span><span id="id6"></span><h2><a href="#aws-apigateway-mockintegration-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#mockIntegration</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Defines an <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/">API Gateway integration</a> that returns a mock response.</dd>
<dt>Trait selector</dt><dd><code class="docutils literal notranslate"><span class="pre">:test(service,</span> <span class="pre">resource,</span> <span class="pre">operation)</span></code></dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">structure</span></code></dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">aws.apigateway#mockIntegration</span></code> trait is a structure that supports the
following members:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>passThroughBehavior</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies how a request payload of unmapped content type is passed
through the integration request without modification. Supported
values are <code class="docutils literal notranslate"><span class="pre">when_no_templates</span></code>, <code class="docutils literal notranslate"><span class="pre">when_no_match</span></code>, and <code class="docutils literal notranslate"><span class="pre">never</span></code>.
For more information, see <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/#passthroughBehavior">Integration.passthroughBehavior</a>.</td>
</tr>
<tr class="row-odd"><td>requestParameters</td>
<td><code class="docutils literal notranslate"><span class="pre">map</span></code> of <a class="reference internal" href="#apigateway-requestparameters"><span class="std std-ref">requestParameters structure</span></a> to request parameters</td>
<td>Specifies mappings from method request parameters to integration
request parameters. Supported request parameters are querystring,
path, header, and body.</td>
</tr>
<tr class="row-even"><td>requestTemplates</td>
<td><code class="docutils literal notranslate"><span class="pre">map</span></code> of media types to <a class="reference internal" href="#apigateway-requesttemplates"><span class="std std-ref">requestTemplates structure</span></a></td>
<td>Mapping templates for a request payload of specified media types.</td>
</tr>
<tr class="row-odd"><td>responses</td>
<td><code class="docutils literal notranslate"><span class="pre">map</span></code> of response codes to <a class="reference internal" href="#apigateway-responses"><span class="std std-ref">responses structure</span></a></td>
<td>Defines the method's responses and specifies desired parameter
mappings or payload mappings from integration responses to method
responses.</td>
</tr>
</tbody>
</table>
<p>The following example defines an operation that uses a mock integration.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;smithy.example#MyOperation&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;operation&quot;</span><span class="p">,</span>
            <span class="nt">&quot;traits&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;smithy.api#http&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;/2&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;aws.apigateway#mockIntegration&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;requestTemplates&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;application/json&quot;</span><span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;application/xml&quot;</span><span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;requestParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;integration.request.path.stage&quot;</span><span class="p">:</span> <span class="s2">&quot;method.request.querystring.version&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;integration.request.querystring.provider&quot;</span><span class="p">:</span> <span class="s2">&quot;method.request.querystring.vendor&quot;</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;responses&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;2\\d{2}&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span><span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.requestId&quot;</span><span class="p">:</span> <span class="s2">&quot;integration.response.header.cid&quot;</span>
                            <span class="p">},</span>
                            <span class="nt">&quot;responseTemplates&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;application/json&quot;</span><span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                                <span class="nt">&quot;application/xml&quot;</span><span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;302&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span><span class="p">:</span> <span class="s2">&quot;302&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.Location&quot;</span><span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span><span class="p">:</span> <span class="s2">&quot;400&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.test-method-response-header&quot;</span><span class="p">:</span> <span class="s2">&quot;&#39;static value&#39;&quot;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="shared-trait-data-types">
<h2><a href="#shared-trait-data-types">Shared trait data types</a></h2>
<p>The following shapes are used throughout the Smithy API Gateway traits
definitions.</p>
<div class="section" id="contenthandling-string">
<span id="apigateway-content-handling"></span><h3><a href="#contenthandling-string">ContentHandling string</a></h3>
<p>Defines the payload conversion handling of a request or response.
Valid values are:</p>
<ul class="simple">
<li>CONVERT_TO_TEXT: for converting a binary payload into a
Base64-encoded string or converting a text payload into a
utf-8-encoded string or passing through the text payload natively
without modification</li>
<li>CONVERT_TO_BINARY: for converting a text payload into
Base64-decoded blob or passing through a binary payload natively
without modification.</li>
</ul>
</div>
<div class="section" id="requestparameters-structure">
<span id="apigateway-requestparameters"></span><h3><a href="#requestparameters-structure">requestParameters structure</a></h3>
<p>Specifies mappings from named method request parameters to integration
request parameters. The method request parameters must be defined before
they are referenced.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="30%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">integration.request.&lt;param-type&gt;.&lt;param-name&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The value must be a predefined method request parameter of the
<code class="docutils literal notranslate"><span class="pre">method.request.&lt;param-type&gt;.&lt;param-name&gt;</span></code> format, where
<code class="docutils literal notranslate"><span class="pre">&lt;param-type&gt;</span></code> can be querystring, path, header, or body. For
the body parameter, the <code class="docutils literal notranslate"><span class="pre">&lt;param-name&gt;</span></code> is a JSON path expression
without the <code class="docutils literal notranslate"><span class="pre">$.</span></code> prefix.</td>
</tr>
</tbody>
</table>
<p>The following request parameter mappings example translates a method
request's query (version), header (x-user-id) and path (service)
parameters to the integration request's query (stage),
header (x-userid), and path parameters (op), respectively.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;requestParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;integration.request.querystring.stage&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.querystring.version&quot;</span><span class="p">,</span>
        <span class="nt">&quot;integration.request.header.x-userid&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.header.x-user-id&quot;</span><span class="p">,</span>
        <span class="nt">&quot;integration.request.path.op&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.path.service&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="requesttemplates-structure">
<span id="apigateway-requesttemplates"></span><h3><a href="#requesttemplates-structure">requestTemplates structure</a></h3>
<p>Specifies mapping templates for a request payload of the specified media types.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&lt;Media</span> <span class="pre">type&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>A <a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/models-mappings.html#models-mappings-mappings">mapping templates</a>.</td>
</tr>
</tbody>
</table>
<p>The following example sets mapping templates for a request payload of the
<code class="docutils literal notranslate"><span class="pre">application/json</span></code> and <code class="docutils literal notranslate"><span class="pre">application/xml</span></code> media types.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;requestTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
        <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="responses-structure">
<span id="apigateway-responses"></span><h3><a href="#responses-structure">responses structure</a></h3>
<p>Defines the method's responses and specifies parameter mappings or payload
mappings from integration responses to method responses.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="20%" />
<col width="10%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&lt;Response</span> <span class="pre">status</span> <span class="pre">pattern&gt;</span></code></td>
<td><a class="reference internal" href="#apigateway-response-structure"><span class="std std-ref">Response structure</span></a></td>
<td><p class="first">Selection regular expression used to match the integration response
to the method response. For HTTP integrations, this regex applies to
the integration response status code. For Lambda invocations, the
regex applies to the errorMessage field of the error information
object returned by AWS Lambda as a failure response body when the
Lambda function execution throws an exception.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Response status pattern property name refers to a response
status code or regular expression describing a group of response
status codes. It does not correspond to any identifier of an
<a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration-response/">IntegrationResponse</a> resource in the API Gateway REST API.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p>The following example shows a list of responses from <code class="docutils literal notranslate"><span class="pre">2xx</span></code> and <code class="docutils literal notranslate"><span class="pre">302</span></code>
responses. For the <code class="docutils literal notranslate"><span class="pre">2xx</span></code> response, the method response is mapped from
the integration response's payload of the <code class="docutils literal notranslate"><span class="pre">application/json</span></code> or
<code class="docutils literal notranslate"><span class="pre">application/xml</span></code> media type. This response uses the supplied mapping
templates. For the <code class="docutils literal notranslate"><span class="pre">302</span></code> response, the method response returns a
<code class="docutils literal notranslate"><span class="pre">Location</span></code> header whose value is derived from the <code class="docutils literal notranslate"><span class="pre">redirect.url</span></code>
property on the integration response's payload.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;responses&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;2\\d{2}&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span>
            <span class="nt">&quot;responseTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nt">&quot;302&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;302&quot;</span><span class="p">,</span>
            <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;method.response.header.Location&quot;</span><span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="response-structure">
<span id="apigateway-response-structure"></span><h3><a href="#response-structure">response structure</a></h3>
<p>Defines a response and specifies parameter mappings or payload mappings from
the integration response to the method response.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="30%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>statusCode</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>HTTP status code for the method response; for example, &quot;200&quot;. This
must correspond to a matching response in the OpenAPI Operation
responses field.</td>
</tr>
<tr class="row-odd"><td>responseTemplates</td>
<td><a class="reference internal" href="#apigateway-response-templates-structure"><span class="std std-ref">Response templates structure</span></a></td>
<td>Specifies media type-specific mapping templates for the response's
payload.</td>
</tr>
<tr class="row-even"><td>responseParameters</td>
<td><a class="reference internal" href="#apigateway-response-parameters-structure"><span class="std std-ref">Response parameters structure</span></a></td>
<td>Specifies parameter mappings for the response. Only the header and
body parameters of the integration response can be mapped to the header
parameters of the method.</td>
</tr>
<tr class="row-odd"><td>contentHandling</td>
<td><a class="reference internal" href="#apigateway-content-handling"><span class="std std-ref">ContentHandling string</span></a></td>
<td>Response payload content handling.</td>
</tr>
</tbody>
</table>
<p>The following example defines a 302 response for the method that derives a
payload of the <code class="docutils literal notranslate"><span class="pre">application/json</span></code> or <code class="docutils literal notranslate"><span class="pre">application/xml</span></code> media type from the
backend. The response uses the supplied mapping templates and returns the
redirect URL from the integration response in the method's Location header.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;302&quot;</span><span class="p">,</span>
    <span class="nt">&quot;responseTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
         <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;method.response.header.Location&quot;</span><span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="response-templates-structure">
<span id="apigateway-response-templates-structure"></span><h3><a href="#response-templates-structure">Response templates structure</a></h3>
<p>Specifies mapping templates for a response payload of the specified
media types.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="30%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&lt;Media</span> <span class="pre">type&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies a mapping template to transform the integration response
body to the method response body for a given media type. For
information about creating a mapping template, see
<a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/models-mappings.html#models-mappings-mappings">mapping templates</a>. An example of a media type is
<code class="docutils literal notranslate"><span class="pre">application/json</span></code>.</td>
</tr>
</tbody>
</table>
<p>The following example sets mapping templates for a request payload of the
<code class="docutils literal notranslate"><span class="pre">application/json</span></code> and <code class="docutils literal notranslate"><span class="pre">application/xml</span></code> media types.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;responseTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
        <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="response-parameters-structure">
<span id="apigateway-response-parameters-structure"></span><h3><a href="#response-parameters-structure">Response parameters structure</a></h3>
<p>Specifies mappings from integration method response parameters to method
response parameters. Only the <code class="docutils literal notranslate"><span class="pre">header</span></code> and <code class="docutils literal notranslate"><span class="pre">body</span></code> types of the integration
response parameters can be mapped to the <code class="docutils literal notranslate"><span class="pre">header</span></code> type of the method
response.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="30%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">method.response.header.&lt;param-name&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The named parameter value can be derived from the header and body
types of the integration response parameters only.</td>
</tr>
</tbody>
</table>
<p>The following example maps <code class="docutils literal notranslate"><span class="pre">body</span></code> and <code class="docutils literal notranslate"><span class="pre">header</span></code> parameters of the
integration response to two <code class="docutils literal notranslate"><span class="pre">header</span></code> parameters of the method response.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;method.response.header.Location&quot;</span> <span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span><span class="p">,</span>
        <span class="nt">&quot;method.response.header.x-user-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;integration.response.header.x-userid&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


                    
                    <section class="relations">
                        
                        <a href="aws-iam.html" title="previous chapter" class="previous-page clearfix hidden-xs">‚Üê AWS IAM traits</a>
                        
                        <a href="aws-cloudformation.html" title="next chapter" class="next-page clearfix">AWS CloudFormation traits ‚Üí</a>
                    </section>
                    
                </article><aside id="right-column" class="side-column hidden-sm">
                    <div class="column-body">
                        <section class="sidebar">
                            
                            <section class="next-previous">
                                
                                <a href="aws-iam.html" title="previous chapter" class="previous-page clearfix hidden-xs">‚Üê Prev</a>
                                
                                <a href="aws-cloudformation.html" title="next chapter" class="next-page clearfix">Next ‚Üí</a>
                            </section>
                            
                            <ul>
<li><a class="reference internal" href="#">Amazon API Gateway traits</a><ul>
<li><a class="reference internal" href="#aws-apigateway-apikeysource-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#apiKeySource</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-authorizers-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizers</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-authorizer-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizer</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-requestvalidator-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#requestValidator</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-integration-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#integration</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-mockintegration-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#mockIntegration</span></code> trait</a></li>
<li><a class="reference internal" href="#shared-trait-data-types">Shared trait data types</a><ul>
<li><a class="reference internal" href="#contenthandling-string">ContentHandling string</a></li>
<li><a class="reference internal" href="#requestparameters-structure">requestParameters structure</a></li>
<li><a class="reference internal" href="#requesttemplates-structure">requestTemplates structure</a></li>
<li><a class="reference internal" href="#responses-structure">responses structure</a></li>
<li><a class="reference internal" href="#response-structure">response structure</a></li>
<li><a class="reference internal" href="#response-templates-structure">Response templates structure</a></li>
<li><a class="reference internal" href="#response-parameters-structure">Response parameters structure</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                        </section>
                    </div>
                </aside></div>
        </section>
        
    
<footer id="footer">
    <div class="width-wrapper">
        <div class="copyright">
            <p>¬©2021, Amazon Web Services, Inc or its affiliates. All rights reserved.</p>
        </div>
    </div>
</footer>
  </body>
</html>