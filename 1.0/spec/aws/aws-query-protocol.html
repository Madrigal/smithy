
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AWS query protocol &#8212; Smithy 1.0 documentation</title><link rel="stylesheet" href="../../../_static/bootstrap-reboot.css" type="text/css" />
    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" href="../../../_static/custom-tabs.css" type="text/css" />

    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script type="text/javascript" src="../../../_static/smithy.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="AWS EC2 query protocol" href="aws-ec2-query-protocol.html" />
    <link rel="prev" title="AWS restXml protocol" href="aws-restxml-protocol.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="smithy-version" content="1.0">

  </head><body>
    <header>
        <div class="header-flex width-wrapper">
            <div class="site-logo">
                <a href="../../../index.html">
                    <span class="logo-icon">üî®Ô∏è</span><span class="logo-text">Smithy</span>
                </a>
                <span class="version-text">1.0</span>
            </div>
            <ul id="page-navigation">
                <li class="site-page first"><a href="../../../quickstart.html">Quick Start</a></li>
                <li class="site-page"><a href="../index.html">Specifications</a></li>
                <li class="site-page"><a href="../../guides/index.html">Guides</a></li>
                <li class="site-page"><a href="https://github.com/awslabs/smithy">Code</a></li>
                <li class="site-search hidden-sm">
                    <form action="../../../search.html" method="get">
                        <input type="hidden" name="check_keywords" value="yes" />
                        <input type="hidden" name="area" value="default" />
                        <input class="search-input" autocomplete="off" type="search" name="q" placeholder="Search" />
                    </form>
                </li>
            </ul>
        </div>
    </header>
    
        
        
        <section id="page-container">
            <div class="width-wrapper flex">
                <article class="document-body">
                    
                    <ul class="rel-parents">
                    <li><a href="../index.html" >Specifications</a></li>
                    <li><a href="index.html" accesskey="U">AWS specifications</a></li>
                    </ul>
                    
                    
  <div class="section" id="aws-query-protocol">
<span id="id1"></span><h1><a href="#aws-query-protocol">AWS query protocol</a></h1>
<p>This document defines the <code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQuery</span></code> protocol.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id5">Overview</a></li>
<li><a class="reference internal" href="#supported-traits" id="id6">Supported traits</a></li>
<li><a class="reference internal" href="#request-serialization" id="id7">Request serialization</a><ul>
<li><a class="reference internal" href="#x-www-form-urlencoded-shape-serialization" id="id8">x-www-form-urlencoded shape serialization</a></li>
<li><a class="reference internal" href="#query-key-resolution" id="id9">Query key resolution</a></li>
<li><a class="reference internal" href="#example-requests" id="id10">Example requests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#response-serialization" id="id11">Response serialization</a><ul>
<li><a class="reference internal" href="#xml-shape-serialization" id="id12">XML shape serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operation-error-serialization" id="id13">Operation error serialization</a></li>
<li><a class="reference internal" href="#non-numeric-float-and-double-serialization" id="id14">Non-numeric float and double serialization</a><ul>
<li><a class="reference internal" href="#error-http-response-status-code-resolution" id="id15">Error HTTP response status code resolution</a></li>
<li><a class="reference internal" href="#error-code-resolution" id="id16">Error &quot;Code&quot; resolution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aws-protocols-awsquery-trait" id="id17"><code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQuery</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-protocols-awsqueryerror-trait" id="id18"><code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQueryError</span></code> trait</a></li>
<li><a class="reference internal" href="#protocol-compliance-tests" id="id19">Protocol compliance tests</a></li>
</ul>
</div>
<div class="section" id="overview">
<h2><a href="#overview">Overview</a></h2>
<p>The AWS Query protocol uses HTTP and serializes HTTP requests using query
string parameters and responses using XML. Requests can be sent using GET
requests and placing parameters in the query string; however, sending
requests using POST with an <code class="docutils literal notranslate"><span class="pre">application/x-www-form-urlencoded</span></code>
Content-Type is preferred because some proxies, clients, and servers have
limitations around the maximum amount of data that can be sent in a query
string.</p>
<p>A service is configured to use this protocol by applying the <a class="reference internal" href="#aws-protocols-awsquery-trait"><span class="std std-ref">aws.protocols#awsQuery trait</span></a>.
The service MUST also define the <a class="reference internal" href="../core/xml-traits.html#xmlnamespace-trait"><span class="std std-ref">xmlNamespace trait</span></a> which is used
to determine the XML namespace used in XML responses.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="kd">use</span><span class="nc"> aws.protocols#awsQuery</span><span class="w"></span>

<span class="nd">@awsQuery</span><span class="w"></span>
<span class="nd">@xmlNamespace</span>(<span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;http://foo.com&quot;</span>)<span class="w"></span>
<span class="kd">service</span><span class="nc"> MyService</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;2020-02-05&quot;</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<ul class="last simple">
<li>This protocol is deprecated and SHOULD NOT be used for any new service.</li>
<li>This protocol does not support document types.</li>
<li>This protocol does not support <a class="reference internal" href="../core/http-traits.html#http-traits"><span class="std std-ref">HTTP binding traits</span></a>.
HTTP binding traits MUST be ignored if they are present.</li>
<li>This protocol does not support any kind of streaming requests or
responses, including event streams.</li>
</ul>
</div>
</div>
<div class="section" id="supported-traits">
<h2><a href="#supported-traits">Supported traits</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQuery</span></code> protocol supports the following traits
that affect serialization:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Trait</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="../core/http-traits.html#cors-trait"><span class="std std-ref">cors</span></a></td>
<td>Indicates that the service supports CORS.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../core/endpoint-traits.html#endpoint-trait"><span class="std std-ref">endpoint</span></a></td>
<td>Configures a custom operation endpoint.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../core/endpoint-traits.html#hostlabel-trait"><span class="std std-ref">hostLabel</span></a></td>
<td>Binds a top-level operation input structure member to a label in
the hostPrefix of an endpoint trait.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../core/xml-traits.html#xmlattribute-trait"><span class="std std-ref">xmlAttribute</span></a></td>
<td>Serializes an object property as an XML attribute rather than a nested
XML element.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened</span></a></td>
<td>By default, entries in lists, sets, and maps have values serialized in
nested elements specific to their type. The <code class="docutils literal notranslate"><span class="pre">xmlFlattened</span></code> trait
unwraps these elements into the containing structure.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName</span></a></td>
<td>By default, the XML element names and form-urlencoded key segments used
in serialized structures are the same as a structure member name. The
<code class="docutils literal notranslate"><span class="pre">xmlName</span></code> trait changes these names to a custom value.  See
<a class="reference internal" href="#aws-protocols-awsqueryname-query-key-naming"><span class="std std-ref">Query key resolution</span></a> for more information.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../core/xml-traits.html#xmlnamespace-trait"><span class="std std-ref">xmlNamespace</span></a></td>
<td>Adds an xmlns namespace definition URI to XML element(s) generated
for the targeted shape.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../core/protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat</span></a></td>
<td>Defines a custom timestamp serialization format.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#aws-protocols-awsqueryerror-trait"><span class="std std-ref">awsQueryError</span></a></td>
<td>Provides a <a class="reference internal" href="#awsquery-error-code"><span class="std std-ref">custom &quot;Code&quot; value</span></a> for
<code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> errors and an <a class="reference internal" href="#awsquery-error-response-code"><span class="std std-ref">HTTP response code</span></a>.
The &quot;Code&quot; of an <code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> error is used by clients to determine
which type of error was encountered.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="request-serialization">
<h2><a href="#request-serialization">Request serialization</a></h2>
<p>Requests SHALL be sent to the root URL (<code class="docutils literal notranslate"><span class="pre">/</span></code>). Requests SHALL use a POST
request and a body that contains input parameters serialized with a
Content-Type of <code class="docutils literal notranslate"><span class="pre">application/x-www-form-urlencoded</span></code>. All keys and
values MUST be encoded according to <span class="target" id="index-0"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc3986.html"><strong>RFC 3986</strong></a>. Requests SHALL contain
a Content-Length header; this protocol does not support chunked
Transfer-Encoding.</p>
<p>Requests MUST include the following key value pairs in the serialized body:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">Action</span></code></td>
<td>The <a class="reference internal" href="../core/model.html#grammar-token-smithy-identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">shape</span> <span class="pre">name</span></code></a> of the operation's <a class="reference internal" href="../core/model.html#shape-id"><span class="std std-ref">Shape ID</span></a>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">Version</span></code></td>
<td>The value of the <a class="reference internal" href="../core/model.html#service"><span class="std std-ref">&quot;version&quot; property of the service</span></a>.</td>
</tr>
</tbody>
</table>
<p>These, along with other input members, are serialized in the request body,
concatenated with the following rules:</p>
<ul class="simple">
<li>&quot;&amp;&quot; is used to separate member key-value pairs.</li>
<li>&quot;=&quot; is used to separate member keys from values.</li>
<li>&quot;.&quot; is used to separate member name segments within keys.</li>
</ul>
<div class="section" id="x-www-form-urlencoded-shape-serialization">
<h3><a href="#x-www-form-urlencoded-shape-serialization">x-www-form-urlencoded shape serialization</a></h3>
<p>Simple shapes are serialized according to the following rules:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Smithy type</th>
<th class="head">Request entity</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">blob</span></code></td>
<td>Text value that is base64 encoded.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">boolean</span></code></td>
<td>Text value of either &quot;true&quot; or &quot;false&quot;.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">byte</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">short</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">long</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">float</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">double</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">bigDecimal</span></code></td>
<td>Text value of the number, using scientific notation if an exponent is
needed. Unfortunately, many parsers will either truncate the value or be
unable to parse numbers that exceed the size of a double.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">bigInteger</span></code></td>
<td>Text value of the number, using scientific notation if an exponent is
needed. Unfortunately, many parsers will either truncate the value or be
unable to parse numbers that exceed the size of a double.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>UTF-8 value of the string. Empty strings are serialized as empty
values, meaning a <code class="docutils literal notranslate"><span class="pre">Foo</span></code> member set to an empty string would be
serialized as &quot;&amp;Foo=&quot;.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></td>
<td>Text value of the timestamp. This protocol uses <code class="docutils literal notranslate"><span class="pre">date-time</span></code> as the
default serialization. However, the <a class="reference internal" href="../core/protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat</span></a>
MAY be used to customize timestamp serialization.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">document</span></code></td>
<td>Undefined. Document shapes are not supported in this protocol.</td>
</tr>
</tbody>
</table>
<p>Aggregate shapes are serialized with additional segments for members appended
to the input's key.</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Smithy type</th>
<th class="head">Request entity</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">list</span></code></td>
<td>Each value provided in the collection is serialized as a separate key with
a &quot;.&quot; separator, the string &quot;member&quot;, a &quot;.&quot; separator, and a &quot;1&quot; indexed
incrementing counter appended to the container's key.
The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be used to serialize a property using a custom name instead of &quot;member&quot;. The <a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened trait</span></a>
can be used to unwrap the values into a containing structure or union,
with the key not containing the initial &quot;.&quot; separator and <code class="docutils literal notranslate"><span class="pre">member</span></code>
segment.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">set</span></code></td>
<td>A set is serialized identically to a <code class="docutils literal notranslate"><span class="pre">list</span></code> shape, but only contains
unique values.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">map</span></code></td>
<td>Each key and value in each pair provided in the map is serialized as a
separate key with a &quot;.&quot; separator, the string &quot;entry&quot;, a &quot;.&quot; separator,
a &quot;1&quot; indexed incrementing counter, a &quot;.&quot; separator, and the string
&quot;key&quot; or &quot;value&quot; (for member keys or values, respectively) appended to
the container's key. The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be used to serialize a property using a custom name instead of &quot;member&quot;, &quot;key&quot;,
or &quot;value&quot;. The <a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened trait</span></a> can be used to unwrap the
values into a containing structure or union, with the key not
containing the initial &quot;.&quot; separator and &quot;entry&quot; segment.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">structure</span></code></td>
<td>Each member value provided for the shape is serialized as a separate key
with a &quot;.&quot; separator and the member name appended to the container's key.
The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be used to serialize a property using a custom name. Members with null values are not serialized.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">union</span></code></td>
<td>A union is serialized identically to a <code class="docutils literal notranslate"><span class="pre">structure</span></code> shape, but only a
single member can be set to a non-null value.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="query-key-resolution">
<span id="aws-protocols-awsqueryname-query-key-naming"></span><h3><a href="#query-key-resolution">Query key resolution</a></h3>
<p>The key component used to serialize a member in a request in <code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> is
resolved using the following process:</p>
<ol class="arabic">
<li><p class="first">Use the value of the <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName</span></a> trait applied to the
member, if present.</p>
</li>
<li><p class="first">Use the default value for the member:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Member location</th>
<th class="head">Default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">list</span></code> member</td>
<td>The string literal &quot;member&quot;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">set</span></code> member</td>
<td>The string literal &quot;member&quot;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">map</span></code> key</td>
<td>The string literal &quot;key&quot;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">map</span></code> value</td>
<td>The string literal &quot;value&quot;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">structure</span></code> member</td>
<td>The <a class="reference internal" href="../core/model.html#grammar-token-smithy-shape_id_member"><code class="xref std std-token docutils literal notranslate"><span class="pre">member</span> <span class="pre">name</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">union</span></code> member</td>
<td>The <a class="reference internal" href="../core/model.html#grammar-token-smithy-shape_id_member"><code class="xref std std-token docutils literal notranslate"><span class="pre">member</span> <span class="pre">name</span></code></a></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
<div class="section" id="example-requests">
<h3><a href="#example-requests">Example requests</a></h3>
<p>The following list of examples are non-exhaustive. See the
<a class="reference internal" href="#awsquery-compliance-tests"><span class="std std-ref">Protocol compliance tests</span></a> for a suite of compliance tests for the
<code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> protocol. Newlines have been to examples only for readability.</p>
<div class="section" id="structures-and-unions">
<h4><a href="#structures-and-unions">Structures and unions</a></h4>
<p>Each member value provided for the shape is serialized as a separate key
with a &quot;.&quot; separator and the member name appended to the container's key.
The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be used to serialize a property using a custom name. Members with null values are not serialized.</p>
<p>For example, given the following:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> QueryStructuresInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">foo:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;Custom&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">bar:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nl">baz:</span><span class="w"> </span><span class="vc">MyStructure</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">structure</span><span class="nc"> MyStructure</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">temp:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">application/x-www-form-urlencoded</span></code> serialization is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: ...
Host: example.com

Action=QueryStructures
&amp;Version=2020-07-02
&amp;foo=example1
&amp;Custom=example2
&amp;baz.temp=example3
</pre></div>
</div>
</div>
<div class="section" id="collections">
<h4><a href="#collections">Collections</a></h4>
<p>Each value provided in the collection is serialized as a separate key with
a &quot;.&quot; separator, the string &quot;member&quot;, a &quot;.&quot; separator, and a &quot;1&quot; indexed
incrementing counter appended to the container's key.
The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be used to serialize a property using a custom name instead of &quot;member&quot;. The <a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened trait</span></a>
can be used to unwrap the values into a containing structure or union,
with the key not containing the initial &quot;.&quot; separator and <code class="docutils literal notranslate"><span class="pre">member</span></code>
segment.</p>
<p>For example, given the following:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> QueryListsInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">ListArg:</span><span class="w"> </span><span class="vc">StringList</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">ComplexListArg:</span><span class="w"> </span><span class="vc">GreetingList</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@xmlFlattened</span><span class="w"></span>
<span class="w">    </span><span class="nl">FlattenedListArg:</span><span class="w"> </span><span class="vc">StringList</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nl">ListArgWithXmlNameMember:</span><span class="w"> </span><span class="vc">ListWithXmlName</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="c">// Notice that the xmlName on the targeted list member is ignored.</span><span class="w"></span>
<span class="w">    </span><span class="nd">@xmlFlattened</span><span class="w"></span>
<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;Hi&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">FlattenedListArgWithXmlName:</span><span class="w"> </span><span class="vc">ListWithXmlName</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">list</span><span class="nc"> ListWithXmlName</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;item&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">member:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">list</span><span class="nc"> StringList</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">member:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">list</span><span class="nc"> GreetingList</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">member:</span><span class="w"> </span><span class="vc">GreetingStruct</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">structure</span><span class="nc"> GreetingStruct</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">hi:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">application/x-www-form-urlencoded</span></code> serialization is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: ...
Host: example.com

Action=QueryLists
&amp;Version=2020-07-02
&amp;ListArg.member.1=foo
&amp;ListArg.member.2=bar
&amp;ListArg.member.3=baz
&amp;ComplexListArg.member.1.hi=hello
&amp;ComplexListArg.member.2.hi=hola
&amp;FlattenedListArg.1=A
&amp;FlattenedListArg.2=B
&amp;ListArgWithXmlNameMember.item.1=A
&amp;ListArgWithXmlNameMember.item.2=B
&amp;Hi.1=A
&amp;Hi.2=B
</pre></div>
</div>
</div>
<div class="section" id="maps">
<h4><a href="#maps">Maps</a></h4>
<p>Each key and value in each pair provided in the map is serialized as a
separate key with a &quot;.&quot; separator, the string &quot;entry&quot;, a &quot;.&quot; separator,
a &quot;1&quot; indexed incrementing counter, a &quot;.&quot; separator, and the string
&quot;key&quot; or &quot;value&quot; (for member keys or values, respectively) appended to
the container's key. The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be used to serialize a property using a custom name instead of &quot;member&quot;, &quot;key&quot;,
or &quot;value&quot;. The <a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened trait</span></a> can be used to unwrap the
values into a containing structure or union, with the key not
containing the initial &quot;.&quot; separator and &quot;entry&quot; segment.</p>
<p>For example, given the following:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> QueryMapsInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">MapArg:</span><span class="w"> </span><span class="vc">StringMap</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;reNamed&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">RenamedMapArg:</span><span class="w"> </span><span class="vc">StringMap</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nl">ComplexMapArg:</span><span class="w"> </span><span class="vc">ComplexMap</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nl">MapWithXmlMemberName:</span><span class="w"> </span><span class="vc">MapWithXmlName</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">map</span><span class="nc"> StringMap</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">key:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">value:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">map</span><span class="nc"> ComplexMap</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">key:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">value:</span><span class="w"> </span><span class="vc">GreetingStruct</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">map</span><span class="nc"> MapWithXmlName</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;K&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">key:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;V&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">value:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">structure</span><span class="nc"> GreetingStruct</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">hi:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">application/x-www-form-urlencoded</span></code> serialization is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: ...
Host: example.com

Action=QueryMaps
&amp;Version=2020-07-02
&amp;MapArg.entry.1.key=bar
&amp;MapArg.entry.1.value=Bar
&amp;MapArg.entry.2.key=foo
&amp;MapArg.entry.2.value=Foo
&amp;reNamed.entry.1.key=foo
&amp;reNamed.entry.1.value=Foo
&amp;ComplexMapArg.entry.1.key=bar
&amp;ComplexMapArg.entry.1.value.hi=Bar
&amp;ComplexMapArg.entry.2.key=foo
&amp;ComplexMapArg.entry.2.value.hi=Foo
&amp;MapWithXmlMemberName.entry.1.K=bar
&amp;MapWithXmlMemberName.entry.1.V=Bar
&amp;MapWithXmlMemberName.entry.2.K=foo
&amp;MapWithXmlMemberName.entry.2.V=Foo
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="response-serialization">
<h2><a href="#response-serialization">Response serialization</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> protocol serializes XML responses within an XML root node with
the name of the operation's output suffixed with &quot;Response&quot;. A nested element,
with the name of the operation's output suffixed with &quot;Result&quot;, contains the
contents of the successful response. A nested element named &quot;ResponseMetadata&quot;
contains a nested element named &quot;RequestId&quot; that contains a unique identifier
for the associated request.</p>
<p>The value of the <code class="docutils literal notranslate"><span class="pre">uri</span></code> member of the <a class="reference internal" href="../core/xml-traits.html#xmlnamespace-trait"><span class="std std-ref">xmlNamespace trait</span></a>
is serialized in an <code class="docutils literal notranslate"><span class="pre">xmlns</span></code> attribute on the response's XML root node. The
following is a sample response to an operation named <code class="docutils literal notranslate"><span class="pre">XmlTest</span></code>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>HTTP/1.1 200 OK
Date: Mon, 27 Jul 2009 12:28:53 GMT
Content-Type: text/xml
Content-Length: ...

<span class="nt">&lt;XmlTestResponse</span> <span class="na">xmlns=</span><span class="s">&quot;https://example.com/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;XmlTestResult&gt;</span>
        <span class="nt">&lt;testValue&gt;</span>Hello!<span class="nt">&lt;/testValue&gt;</span>
    <span class="nt">&lt;/XmlTestResult&gt;</span>
    <span class="nt">&lt;ResponseMetadata&gt;</span>
        <span class="nt">&lt;RequestId&gt;</span>c6104cbe-af31-11e0-8154-cbc7ccf896c7<span class="nt">&lt;/RequestId&gt;</span>
    <span class="nt">&lt;/ResponseMetadata&gt;</span>
<span class="nt">&lt;/XmlTestResponse&gt;</span>
</pre></div>
</div>
<div class="section" id="xml-shape-serialization">
<h3><a href="#xml-shape-serialization">XML shape serialization</a></h3>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Smithy type</th>
<th class="head">XML entity</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">blob</span></code></td>
<td>XML text node with a value that is base64 encoded.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">boolean</span></code></td>
<td>XML text node with a value either &quot;true&quot; or &quot;false&quot;.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">byte</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">short</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">long</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">float</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">double</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">bigDecimal</span></code></td>
<td>XML text node with a value of the number, using scientific notation if
an exponent is needed. Unfortunately, many XML parsers will either
truncate the value or be unable to parse numbers that exceed the size
of a double.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">bigInteger</span></code></td>
<td>XML text node with a value of the number, using scientific notation if
an exponent is needed. Unfortunately, many XML parsers will either
truncate the value or be unable to parse numbers that exceed the size
of a double.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>XML text node with an XML-safe, UTF-8 value of the string.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></td>
<td>XML text node with a value of the timestamp. This protocol uses
<code class="docutils literal notranslate"><span class="pre">date-time</span></code> as the default serialization. However, the
<a class="reference internal" href="../core/protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat</span></a> MAY be used to
customize timestamp serialization.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">document</span></code></td>
<td>Undefined. Document shapes are not supported in this protocol.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">list</span></code></td>
<td>XML element. Each value provided in the list is serialized as a nested
XML element with the name <code class="docutils literal notranslate"><span class="pre">member</span></code>. The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be
used to serialize a property using a custom name. The
<a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened trait</span></a> can be used to unwrap the values into a
containing structure or union, with the value XML element using the
structure or union member name. See <a class="reference internal" href="../core/xml-traits.html#xml-list-and-set-serialization"><span class="std std-ref">List and set serialization</span></a>
for more.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">set</span></code></td>
<td>XML element. A set is serialized identically to a <code class="docutils literal notranslate"><span class="pre">list</span></code> shape,
but only contains unique values.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">map</span></code></td>
<td>XML element. Each key-value pair provided in the map is serialized in
a nested XML element with the name <code class="docutils literal notranslate"><span class="pre">entry</span></code> that contains nested
elements <code class="docutils literal notranslate"><span class="pre">key</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> for the pair. The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a>
can be used to serialize key or value properties using a custom name,
it cannot be used to influence the <code class="docutils literal notranslate"><span class="pre">entry</span></code> name. The
<a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened trait</span></a> can be used to unwrap the entries into a
containing structure or union, with the entry XML element using the
structure or union member name. See <a class="reference internal" href="../core/xml-traits.html#xml-map-serialization"><span class="std std-ref">Map serialization</span></a> for
more.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">structure</span></code></td>
<td>XML element. Each member value provided for the structure is
serialized as a nested XML element where the element name is the
same as the member name. The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be used to
serialize a property using a custom name. The <a class="reference internal" href="../core/xml-traits.html#xmlattribute-trait"><span class="std std-ref">xmlAttribute trait</span></a>
can be used to serialize a property in an attribute of the containing
element. See <a class="reference internal" href="../core/xml-traits.html#xml-structure-and-union-serialization"><span class="std std-ref">Structure and union serialization</span></a> for more.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">union</span></code></td>
<td>XML element. A union is serialized identically to a <code class="docutils literal notranslate"><span class="pre">structure</span></code>
shape, but only a single member can be set to a non-null value.</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">See <a class="reference internal" href="../core/xml-traits.html#serializing-xml-shapes"><span class="std std-ref">Serializing XML shapes</span></a> for comprehensive documentation,
including examples and behaviors when using multiple XML traits.</p>
</div>
</div>
</div>
<div class="section" id="operation-error-serialization">
<span id="awsquery-errors"></span><h2><a href="#operation-error-serialization">Operation error serialization</a></h2>
<p>Error response bodies in the <code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> protocol are wrapped within an XML
root node named <code class="docutils literal notranslate"><span class="pre">ErrorResponse</span></code>. A nested element, named <code class="docutils literal notranslate"><span class="pre">Error</span></code>, contains
the serialized error structure members. <a class="reference internal" href="#awsquery-error-response-code"><span class="std std-ref">The HTTP response code is a
resolved value.</span></a></p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">AWS Query error example</span><a class="headerlink" href="#id4" title="Permalink to this code">¬∂</a></div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>HTTP/1.1 400 Bad Request
Date: Mon, 27 Jul 2009 12:28:53 GMT
Content-Type: text/xml
Content-Length: ...

<span class="nt">&lt;ErrorResponse&gt;</span>
    <span class="nt">&lt;Error&gt;</span>
        <span class="nt">&lt;Type&gt;</span>Sender<span class="nt">&lt;/Type&gt;</span>
        <span class="nt">&lt;Code&gt;</span>InvalidGreeting<span class="nt">&lt;/Code&gt;</span>
        <span class="nt">&lt;Message&gt;</span>Hi<span class="nt">&lt;/Message&gt;</span>
        <span class="nt">&lt;AnotherSetting&gt;</span>setting<span class="nt">&lt;/AnotherSetting&gt;</span>
    <span class="nt">&lt;/Error&gt;</span>
    <span class="nt">&lt;RequestId&gt;</span>c6104cbe-af31-11e0-8154-cbc7ccf896c7<span class="nt">&lt;/RequestId&gt;</span>
<span class="nt">&lt;/ErrorResponse&gt;</span>
</pre></div>
</div>
</div>
<p>Error responses contain the following nested elements:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Error</span></code>: A container for the encountered error.</li>
<li><code class="docutils literal notranslate"><span class="pre">Type</span></code>: One of &quot;Sender&quot; or &quot;Receiver&quot;; whomever is at fault from
the service perspective.</li>
<li><code class="docutils literal notranslate"><span class="pre">Code</span></code>: The <a class="reference internal" href="#awsquery-error-code"><span class="std std-ref">resolved error code value</span></a>
that is used to distinguish which specific error is serialized in
the response.</li>
<li><code class="docutils literal notranslate"><span class="pre">RequestId</span></code>: Contains a unique identifier for the associated request.</li>
</ul>
<p>In the above example, <code class="docutils literal notranslate"><span class="pre">Message</span></code>, and <code class="docutils literal notranslate"><span class="pre">AnotherSetting</span></code> are additional,
hypothetical members of the serialized error structure.</p>
</div>
<div class="section" id="non-numeric-float-and-double-serialization">
<span id="awsquery-non-numeric-float-serialization"></span><h2><a href="#non-numeric-float-and-double-serialization">Non-numeric float and double serialization</a></h2>
<p>Smithy floats and doubles are defined by IEEE-754, which includes special values
for &quot;not a number&quot; and both positive and negative infinity. Unless otherwise
specified, the <code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> protocol treats those special values as
strings with the following values:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Special Value</th>
<th class="head">String Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Not a number</td>
<td><code class="docutils literal notranslate"><span class="pre">NaN</span></code></td>
</tr>
<tr class="row-odd"><td>Positive infinity</td>
<td><code class="docutils literal notranslate"><span class="pre">Infinity</span></code></td>
</tr>
<tr class="row-even"><td>Negative infinity</td>
<td><code class="docutils literal notranslate"><span class="pre">-Infinity</span></code></td>
</tr>
</tbody>
</table>
<div class="section" id="error-http-response-status-code-resolution">
<span id="awsquery-error-response-code"></span><h3><a href="#error-http-response-status-code-resolution">Error HTTP response status code resolution</a></h3>
<p>The status code of an error is <code class="docutils literal notranslate"><span class="pre">400</span></code>, <code class="docutils literal notranslate"><span class="pre">500</span></code>, or a custom status code
defined by the <a class="reference internal" href="#aws-protocols-awsqueryerror-trait"><span class="std std-ref">aws.protocols#awsQueryError trait</span></a>. The status code
is determined through the following process:</p>
<ol class="arabic simple">
<li>Use the value of the <code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> member of the <a class="reference internal" href="#aws-protocols-awsqueryerror-trait"><span class="std std-ref">aws.protocols#awsQueryError trait</span></a>
applied to the error structure, if present.</li>
<li>Use the value <code class="docutils literal notranslate"><span class="pre">400</span></code> if the value of the <a class="reference internal" href="../core/type-refinement-traits.html#error-trait"><span class="std std-ref">error trait</span></a> is <code class="docutils literal notranslate"><span class="pre">&quot;client&quot;</span></code>.</li>
<li>Use the value <code class="docutils literal notranslate"><span class="pre">500</span></code>.</li>
</ol>
</div>
<div class="section" id="error-code-resolution">
<span id="awsquery-error-code"></span><h3><a href="#error-code-resolution">Error &quot;Code&quot; resolution</a></h3>
<p>The value of the &quot;Code&quot; element serialized in the error is resolved using the
following process:</p>
<ol class="arabic simple">
<li>Use the value of the <code class="docutils literal notranslate"><span class="pre">code</span></code> member of the <a class="reference internal" href="#aws-protocols-awsqueryerror-trait"><span class="std std-ref">aws.protocols#awsQueryError trait</span></a>
applied to the error structure, if present.</li>
<li>The <a class="reference internal" href="../core/model.html#grammar-token-smithy-identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">shape</span> <span class="pre">name</span></code></a> of the error's <a class="reference internal" href="../core/model.html#shape-id"><span class="std std-ref">Shape ID</span></a>.</li>
</ol>
</div>
</div>
<div class="section" id="aws-protocols-awsquery-trait">
<span id="aws-protocols-awsquery-trait"></span><span id="id2"></span><h2><a href="#aws-protocols-awsquery-trait"><code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQuery</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Adds support for the awsQuery protocol to a service. The service MUST have
an <a class="reference internal" href="../core/xml-traits.html#xmlnamespace-trait"><span class="std std-ref">xmlNamespace trait</span></a>.</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">service</span> <span class="pre">[trait|xmlNamespace]</span></code></p>
<p><em>Service shapes with the xmlNamespace trait</em></p>
</dd>
<dt>Value type</dt><dd>Annotation trait.</dd>
<dt>See</dt><dd><a class="reference external" href="https://github.com/awslabs/smithy/tree/1.21.0/smithy-aws-protocol-tests/model/awsQuery">Protocol tests</a></dd>
</dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-U21pdGh5" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U21pdGh5" name="U21pdGh5" role="tab" tabindex="0">Smithy</button><button aria-controls="panel-0-SlNPTg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-SlNPTg==" name="SlNPTg==" role="tab" tabindex="-1">JSON</button></div><div aria-labelledby="tab-0-U21pdGh5" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-U21pdGh5" name="U21pdGh5" role="tabpanel" tabindex="0"><div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="kd">use</span><span class="nc"> aws.protocols#awsQuery</span><span class="w"></span>

<span class="nd">@awsQuery</span><span class="w"></span>
<span class="nd">@xmlNamespace</span>(<span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;http://foo.com&quot;</span>)<span class="w"></span>
<span class="kd">service</span><span class="nc"> MyService</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;2020-02-05&quot;</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-SlNPTg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-SlNPTg==" name="SlNPTg==" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;smithy.example#MyService&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
            <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-02-05&quot;</span><span class="p">,</span>
            <span class="nt">&quot;traits&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;aws.protocols#awsQuery&quot;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="nt">&quot;smithy.api#xmlNamespace&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;example.com&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="aws-protocols-awsqueryerror-trait">
<span id="aws-protocols-awsqueryerror-trait"></span><span id="id3"></span><h2><a href="#aws-protocols-awsqueryerror-trait"><code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQueryError</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Provides a <a class="reference internal" href="#awsquery-error-code"><span class="std std-ref">custom &quot;Code&quot; value</span></a> for
<code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> errors and an <a class="reference internal" href="#awsquery-error-response-code"><span class="std std-ref">HTTP response code</span></a>.
The &quot;Code&quot; of an <code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> error is used by clients to determine which
type of error was encountered.</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">structure</span> <span class="pre">[trait|error]</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">awsQueryError</span></code> trait can only be applied to <a class="reference internal" href="../core/model.html#structure"><span class="std std-ref">structure</span></a>
shapes that also have the <a class="reference internal" href="../core/type-refinement-traits.html#error-trait"><span class="std std-ref">error trait</span></a>.</p>
</dd>
<dt>Value type</dt><dd><p><code class="docutils literal notranslate"><span class="pre">structure</span></code> that supports the following members:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="10%" />
<col width="25%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>code</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required</strong> The value used to distinguish this error shape during
client deserialization.</td>
</tr>
<tr class="row-odd"><td>httpResponseCode</td>
<td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td><strong>Required</strong> The HTTP response code used on a response that contains
this error shape.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQueryError</span></code> trait is only used when serializing
operation errors using the <code class="docutils literal notranslate"><span class="pre">aws.protocols#query</span></code> protocol. Unless
explicitly stated in other Smithy protocol specification, this trait has
no impact on other Smithy protocols.</p>
</div>
<p>The following example defines an error that uses a custom &quot;Code&quot; of
&quot;InvalidThing&quot; and an HTTP status code of 400.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-U21pdGh5" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U21pdGh5" name="U21pdGh5" role="tab" tabindex="0">Smithy</button><button aria-controls="panel-1-SlNPTg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-SlNPTg==" name="SlNPTg==" role="tab" tabindex="-1">JSON</button></div><div aria-labelledby="tab-1-U21pdGh5" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-U21pdGh5" name="U21pdGh5" role="tabpanel" tabindex="0"><div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">use</span><span class="nc"> aws.protocols#awsQueryError</span><span class="w"></span>

<span class="nd">@awsQueryError</span>(<span class="w"></span>
<span class="w">    </span><span class="nl">code:</span><span class="w"> </span><span class="s2">&quot;InvalidThing&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">httpResponseCode:</span><span class="w"> </span><span class="m">400</span><span class="p">,</span><span class="w"></span>
)<span class="w"></span>
<span class="nd">@error</span>(<span class="s2">&quot;client&quot;</span>)<span class="w"></span>
<span class="kd">structure</span><span class="nc"> InvalidThingException</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">message:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-SlNPTg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-SlNPTg==" name="SlNPTg==" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;smithy.example#InvalidThingException&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="nt">&quot;members&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;smithy.api#String&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;traits&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;aws.protocols#awsQueryError&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;InvalidThing&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;httpResponseCode&quot;</span><span class="p">:</span> <span class="mi">400</span>
                <span class="p">},</span>
                <span class="nt">&quot;smithy.api#error&quot;</span><span class="p">:</span> <span class="s2">&quot;client&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="protocol-compliance-tests">
<span id="awsquery-compliance-tests"></span><h2><a href="#protocol-compliance-tests">Protocol compliance tests</a></h2>
<p>A full compliance test suite is provided and SHALL be considered a normative
reference: <a class="reference external" href="https://github.com/awslabs/smithy/tree/main/smithy-aws-protocol-tests/model/awsQuery">https://github.com/awslabs/smithy/tree/main/smithy-aws-protocol-tests/model/awsQuery</a></p>
<p>These compliance tests define a model that is used to define test cases and
the expected serialized HTTP requests and responses for each case.</p>
</div>
</div>


                    
                    <section class="relations">
                        
                        <a href="aws-restxml-protocol.html" title="previous chapter" class="previous-page clearfix hidden-xs">‚Üê AWS restXml protocol</a>
                        
                        <a href="aws-ec2-query-protocol.html" title="next chapter" class="next-page clearfix">AWS EC2 query protocol ‚Üí</a>
                    </section>
                    
                </article><aside id="right-column" class="side-column hidden-sm">
                    <div class="column-body">
                        <section class="sidebar">
                            
                            <section class="next-previous">
                                
                                <a href="aws-restxml-protocol.html" title="previous chapter" class="previous-page clearfix hidden-xs">‚Üê Prev</a>
                                
                                <a href="aws-ec2-query-protocol.html" title="next chapter" class="next-page clearfix">Next ‚Üí</a>
                            </section>
                            
                            <ul>
<li><a class="reference internal" href="#">AWS query protocol</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#supported-traits">Supported traits</a></li>
<li><a class="reference internal" href="#request-serialization">Request serialization</a><ul>
<li><a class="reference internal" href="#x-www-form-urlencoded-shape-serialization">x-www-form-urlencoded shape serialization</a></li>
<li><a class="reference internal" href="#query-key-resolution">Query key resolution</a></li>
<li><a class="reference internal" href="#example-requests">Example requests</a><ul>
<li><a class="reference internal" href="#structures-and-unions">Structures and unions</a></li>
<li><a class="reference internal" href="#collections">Collections</a></li>
<li><a class="reference internal" href="#maps">Maps</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#response-serialization">Response serialization</a><ul>
<li><a class="reference internal" href="#xml-shape-serialization">XML shape serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operation-error-serialization">Operation error serialization</a></li>
<li><a class="reference internal" href="#non-numeric-float-and-double-serialization">Non-numeric float and double serialization</a><ul>
<li><a class="reference internal" href="#error-http-response-status-code-resolution">Error HTTP response status code resolution</a></li>
<li><a class="reference internal" href="#error-code-resolution">Error &quot;Code&quot; resolution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aws-protocols-awsquery-trait"><code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQuery</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-protocols-awsqueryerror-trait"><code class="docutils literal notranslate"><span class="pre">aws.protocols#awsQueryError</span></code> trait</a></li>
<li><a class="reference internal" href="#protocol-compliance-tests">Protocol compliance tests</a></li>
</ul>
</li>
</ul>

                        </section>
                    </div>
                </aside></div>
        </section>
        
    
<footer id="footer">
    <div class="width-wrapper">
        <div class="copyright">
            <p>¬©2021, Amazon Web Services, Inc or its affiliates. All rights reserved.</p>
        </div>
    </div>
</footer>
  </body>
</html>