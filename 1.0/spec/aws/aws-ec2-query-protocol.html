
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AWS EC2 query protocol &#8212; Smithy 1.0 documentation</title><link rel="stylesheet" href="../../../_static/bootstrap-reboot.css" type="text/css" />
    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" href="../../../_static/custom-tabs.css" type="text/css" />

    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script type="text/javascript" src="../../../_static/smithy.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="AWS Service Customizations" href="customizations/index.html" />
    <link rel="prev" title="AWS query protocol" href="aws-query-protocol.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="smithy-version" content="1.0">

  </head><body>
    <header>
        <div class="header-flex width-wrapper">
            <div class="site-logo">
                <a href="../../../index.html">
                    <span class="logo-icon">üî®Ô∏è</span><span class="logo-text">Smithy</span>
                </a>
                <span class="version-text">1.0</span>
            </div>
            <ul id="page-navigation">
                <li class="site-page first"><a href="../../../quickstart.html">Quick Start</a></li>
                <li class="site-page"><a href="../index.html">Specifications</a></li>
                <li class="site-page"><a href="../../guides/index.html">Guides</a></li>
                <li class="site-page"><a href="https://github.com/awslabs/smithy">Code</a></li>
                <li class="site-search hidden-sm">
                    <form action="../../../search.html" method="get">
                        <input type="hidden" name="check_keywords" value="yes" />
                        <input type="hidden" name="area" value="default" />
                        <input class="search-input" autocomplete="off" type="search" name="q" placeholder="Search" />
                    </form>
                </li>
            </ul>
        </div>
    </header>
    
        
        
        <section id="page-container">
            <div class="width-wrapper flex">
                <article class="document-body">
                    
                    <ul class="rel-parents">
                    <li><a href="../index.html" >Specifications</a></li>
                    <li><a href="index.html" accesskey="U">AWS specifications</a></li>
                    </ul>
                    
                    
  <div class="section" id="aws-ec2-query-protocol">
<span id="id1"></span><h1><a href="#aws-ec2-query-protocol">AWS EC2 query protocol</a></h1>
<p>This specification defines the <code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2</span></code> protocol.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#aws-protocols-ec2query-trait" id="id4"><code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2Query</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-protocols-ec2queryname-trait" id="id5"><code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2QueryName</span></code> trait</a><ul>
<li><a class="reference internal" href="#query-key-resolution" id="id6">Query key resolution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#supported-traits" id="id7">Supported traits</a></li>
<li><a class="reference internal" href="#request-serialization" id="id8">Request serialization</a><ul>
<li><a class="reference internal" href="#x-www-form-urlencoded-shape-serialization" id="id9">x-www-form-urlencoded shape serialization</a></li>
<li><a class="reference internal" href="#examples" id="id10">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#response-serialization" id="id11">Response serialization</a><ul>
<li><a class="reference internal" href="#xml-shape-serialization" id="id12">XML shape serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operation-error-serialization" id="id13">Operation error serialization</a></li>
<li><a class="reference internal" href="#non-numeric-float-and-double-serialization" id="id14">Non-numeric float and double serialization</a></li>
<li><a class="reference internal" href="#protocol-compliance-tests" id="id15">Protocol compliance tests</a></li>
</ul>
</div>
<div class="section" id="aws-protocols-ec2query-trait">
<span id="aws-protocols-ec2query-trait"></span><span id="id2"></span><h2><a href="#aws-protocols-ec2query-trait"><code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2Query</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Adds support for an HTTP protocol that sends requests in a
<code class="docutils literal notranslate"><span class="pre">application/x-www-form-url-encoded</span></code> body and responses in XML
documents. This protocol is an Amazon EC2-specific extension
of the <code class="docutils literal notranslate"><span class="pre">awsQuery</span></code> protocol.</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">service</span> <span class="pre">[trait|xmlNamespace]</span></code></p>
<p><em>Service shapes with the xmlNamespace trait</em></p>
</dd>
<dt>Value type</dt><dd>Annotation trait.</dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This protocol does not support document types.</p>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-U21pdGh5" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U21pdGh5" name="U21pdGh5" role="tab" tabindex="0">Smithy</button><button aria-controls="panel-0-SlNPTg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-SlNPTg==" name="SlNPTg==" role="tab" tabindex="-1">JSON</button></div><div aria-labelledby="tab-0-U21pdGh5" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-U21pdGh5" name="U21pdGh5" role="tabpanel" tabindex="0"><div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="kd">use</span><span class="nc"> aws.protocols#ec2Query</span><span class="w"></span>

<span class="nd">@ec2Query</span><span class="w"></span>
<span class="kd">service</span><span class="nc"> MyService</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">version:</span><span class="w"> </span><span class="s2">&quot;2020-02-05&quot;</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-SlNPTg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-SlNPTg==" name="SlNPTg==" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;smithy.example#MyService&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
            <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-02-05&quot;</span><span class="p">,</span>
            <span class="nt">&quot;traits&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;aws.protocols#ec2Query&quot;</span><span class="p">:</span> <span class="p">{}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="aws-protocols-ec2queryname-trait">
<span id="aws-protocols-ec2queryname-trait"></span><span id="id3"></span><h2><a href="#aws-protocols-ec2queryname-trait"><code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2QueryName</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Allows a serialized query key to differ from a structure member name when
used in the model.</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">structure</span> <span class="pre">&gt;</span> <span class="pre">member</span></code></p>
<p><em>Any structure member</em></p>
</dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">string</span></code></dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2QueryName</span></code> trait is only used when serializing
operation inputs using the <code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2</span></code> protocol.</p>
</div>
<p>Given the following structure definition:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-U21pdGh5" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U21pdGh5" name="U21pdGh5" role="tab" tabindex="0">Smithy</button><button aria-controls="panel-1-SlNPTg==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-SlNPTg==" name="SlNPTg==" role="tab" tabindex="-1">JSON</button></div><div aria-labelledby="tab-1-U21pdGh5" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-U21pdGh5" name="U21pdGh5" role="tabpanel" tabindex="0"><div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">use</span><span class="nc"> aws.protocols#ec2QueryName</span><span class="w"></span>

<span class="kd">structure</span><span class="nc"> MyStruct</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@ec2QueryName</span>(<span class="s2">&quot;foo&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">bar:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-SlNPTg==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-SlNPTg==" name="SlNPTg==" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;smithy.example#MyStruct&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="nt">&quot;members&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;bar&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;smithy.api#String&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;traits&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;aws.protocols#ec2QueryName&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<p>and the following values provided for <code class="docutils literal notranslate"><span class="pre">MyStruct</span></code>,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;bar&quot;</span> <span class="o">=</span> <span class="s2">&quot;baz&quot;</span>
</pre></div>
</div>
<p>the serialization of this structure as an input on the <code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2</span></code>
protocol is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MyStruct</span><span class="o">.</span><span class="n">foo</span><span class="o">=</span><span class="n">baz</span>
</pre></div>
</div>
<div class="section" id="query-key-resolution">
<span id="aws-protocols-ec2queryname-query-key-naming"></span><h3><a href="#query-key-resolution">Query key resolution</a></h3>
<p>The key component used to serialize a member in a request in <code class="docutils literal notranslate"><span class="pre">ec2Query</span></code> is
resolved using the following process:</p>
<ol class="arabic">
<li><p class="first">Use the value of the <a class="reference internal" href="#aws-protocols-ec2queryname-trait"><span class="std std-ref">aws.protocols#ec2QueryName trait</span></a> applied to the
member, if present.</p>
</li>
<li><p class="first">Use the value of the <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> applied to the
member with the first letter capitalized, if present.</p>
</li>
<li><p class="first">Use the default value for the member, if present:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Member location</th>
<th class="head">Default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">structure</span></code> member</td>
<td>The <a class="reference internal" href="../core/model.html#grammar-token-smithy-shape_id_member"><code class="xref std std-token docutils literal notranslate"><span class="pre">member</span> <span class="pre">name</span></code></a> capitalized</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">union</span></code> member</td>
<td>The <a class="reference internal" href="../core/model.html#grammar-token-smithy-shape_id_member"><code class="xref std std-token docutils literal notranslate"><span class="pre">member</span> <span class="pre">name</span></code></a> capitalized</td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
<div class="section" id="supported-traits">
<h2><a href="#supported-traits">Supported traits</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2Query</span></code> protocol supports the following traits
that affect serialization:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Trait</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="../core/http-traits.html#cors-trait"><span class="std std-ref">cors</span></a></td>
<td>Indicates that the service supports CORS.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../core/endpoint-traits.html#endpoint-trait"><span class="std std-ref">endpoint</span></a></td>
<td>Configures a custom operation endpoint.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../core/endpoint-traits.html#hostlabel-trait"><span class="std std-ref">hostLabel</span></a></td>
<td>Binds a top-level operation input structure member to a label in
the hostPrefix of an endpoint trait.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">ec2QueryName</span></a></td>
<td>By default, the form-urlencoded key segments used in serialized
structures are the same as a structure member name. The <code class="docutils literal notranslate"><span class="pre">ec2QueryName</span></code>
changes the key segment name to a custom value. See
<a class="reference internal" href="#aws-protocols-ec2queryname-query-key-naming"><span class="std std-ref">Query key resolution</span></a> for more information.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../core/xml-traits.html#xmlattribute-trait"><span class="std std-ref">xmlAttribute</span></a></td>
<td>Serializes an object property as an XML attribute rather than a nested
XML element.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened</span></a></td>
<td>By default, entries in lists, sets, and maps have values serialized in
nested elements specific to their type. The <code class="docutils literal notranslate"><span class="pre">xmlFlattened</span></code> trait
unwraps these elements into the containing structure.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName</span></a></td>
<td>By default, the XML element names and form-urlencoded key segments used
in serialized structures are the same as a structure member name. The
<code class="docutils literal notranslate"><span class="pre">xmlName</span></code> trait changes the these names to a custom value. See
<a class="reference internal" href="#aws-protocols-ec2queryname-query-key-naming"><span class="std std-ref">Query key resolution</span></a> for more information.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../core/xml-traits.html#xmlnamespace-trait"><span class="std std-ref">xmlNamespace</span></a></td>
<td>Adds an xmlns namespace definition URI to XML element(s) generated
for the targeted shape.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../core/protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat</span></a></td>
<td>Defines a custom timestamp serialization format.</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This protocol does not support document types.</p>
</div>
</div>
<div class="section" id="request-serialization">
<h2><a href="#request-serialization">Request serialization</a></h2>
<p>Requests SHALL be sent to the root URL (<code class="docutils literal notranslate"><span class="pre">/</span></code>). Requests SHALL use a POST
request and a body that contains input parameters serialized with a
Content-Type of <code class="docutils literal notranslate"><span class="pre">application/x-www-form-urlencoded</span></code>. All keys and
values MUST be encoded according to <span class="target" id="index-0"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc3986.html"><strong>RFC 3986</strong></a>. Requests SHALL contain
a Content-Length header; this protocol does not support chunked
Transfer-Encoding.</p>
<p>Requests MUST include the following key value pairs in the serialized body:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">Action</span></code></td>
<td>The <a class="reference internal" href="../core/model.html#grammar-token-smithy-identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">shape</span> <span class="pre">name</span></code></a> of the operation's <a class="reference internal" href="../core/model.html#shape-id"><span class="std std-ref">Shape ID</span></a>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">Version</span></code></td>
<td>The value of the <a class="reference internal" href="../core/model.html#service"><span class="std std-ref">&quot;version&quot; property of the service</span></a>.</td>
</tr>
</tbody>
</table>
<p>These, along with other input members, are serialized in the request body,
concatenated with the following rules:</p>
<ul class="simple">
<li>&quot;&amp;&quot; is used to separate member key-value pairs.</li>
<li>&quot;=&quot; is used to separate member keys from values.</li>
<li>&quot;.&quot; is used to separate member name segments within keys.</li>
</ul>
<div class="section" id="x-www-form-urlencoded-shape-serialization">
<h3><a href="#x-www-form-urlencoded-shape-serialization">x-www-form-urlencoded shape serialization</a></h3>
<p>Simple shapes are serialized according to the following rules:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Smithy type</th>
<th class="head">Request entity</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">blob</span></code></td>
<td>Text value that is base64 encoded.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">boolean</span></code></td>
<td>Text value of either &quot;true&quot; or &quot;false&quot;.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">byte</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">short</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">long</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">float</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">double</span></code></td>
<td>Text value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">bigDecimal</span></code></td>
<td>Text value of the number, using scientific notation if an exponent is
needed. Unfortunately, many parsers will either truncate the value or be
unable to parse numbers that exceed the size of a double.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">bigInteger</span></code></td>
<td>Text value of the number, using scientific notation if an exponent is
needed. Unfortunately, many parsers will either truncate the value or be
unable to parse numbers that exceed the size of a double.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>UTF-8 value of the string. Empty strings are serialized as empty
values, meaning a <code class="docutils literal notranslate"><span class="pre">Foo</span></code> member set to an empty string would be
serialized as &quot;&amp;Foo=&quot;.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></td>
<td>Text value of the timestamp. This protocol uses <code class="docutils literal notranslate"><span class="pre">date-time</span></code> as the
default serialization. However, the <a class="reference internal" href="../core/protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat</span></a>
MAY be used to customize timestamp serialization.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">document</span></code></td>
<td>Undefined. Document shapes are not supported in this protocol.</td>
</tr>
</tbody>
</table>
<p>Aggregate shapes are serialized with additional segments for members appended
to the input's key.</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Smithy type</th>
<th class="head">Request entity</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">list</span></code></td>
<td>Each value provided in the collection is serialized as a separate key with
a &quot;.&quot; separator and a &quot;1&quot; indexed incrementing counter appended to the
container's key.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">set</span></code></td>
<td>A set is serialized identically to a <code class="docutils literal notranslate"><span class="pre">list</span></code> shape, but only contains
unique values.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">map</span></code></td>
<td>Map serialization is currently undefined for this protocol.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">structure</span></code></td>
<td>Each member value provided for the shape is serialized as a separate key
with a &quot;.&quot; separator and the member name appended to the container's key.
See <a class="reference internal" href="#aws-protocols-ec2queryname-query-key-naming"><span class="std std-ref">Query key resolution</span></a>
for how to serialize a property using a custom name. Members with null values are not serialized.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">union</span></code></td>
<td>A union is serialized identically to a <code class="docutils literal notranslate"><span class="pre">structure</span></code> shape, but only a
single member can be set to a non-null value.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h3><a href="#examples">Examples</a></h3>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">These examples are non-exhaustive. See the <a class="reference internal" href="#ec2query-compliance-tests"><span class="std std-ref">Protocol compliance tests</span></a>
for a suite of compliance tests for the <code class="docutils literal notranslate"><span class="pre">ec2Query</span></code> protocol.</p>
</div>
<div class="section" id="structures-and-unions">
<h4><a href="#structures-and-unions">Structures and Unions</a></h4>
<p>Each member value provided for the shape is serialized as a separate key
with a &quot;.&quot; separator and the member name appended to the container's key.
See <a class="reference internal" href="#aws-protocols-ec2queryname-query-key-naming"><span class="std std-ref">Query key resolution</span></a>
for how to serialize a property using a custom name. Members with null values are not serialized.</p>
<p>For example, given the following:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> Ec2QueryStructuresInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">foo:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@ec2QueryName</span>(<span class="s2">&quot;A&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">HasQueryName:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@ec2QueryName</span>(<span class="s2">&quot;B&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;IgnoreMe&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">HasQueryAndXmlName:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;c&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">UsesXmlName:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nl">baz:</span><span class="w"> </span><span class="vc">MyStructure</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">structure</span><span class="nc"> MyStructure</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">temp:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">x-www-form-urlencoded</span></code> serialization is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Action=Ec2QueryStructures
&amp;Version=2020-07-02
&amp;Foo=bar
&amp;A=example0
&amp;B=example1
&amp;C=example2
&amp;Baz.Temp=example3
</pre></div>
</div>
</div>
<div class="section" id="collections">
<h4><a href="#collections">Collections</a></h4>
<p>Each value provided in the collection is serialized as a separate key with
a &quot;.&quot; separator and a &quot;1&quot; indexed incrementing counter appended to the
container's key.</p>
<p>For example, given the following:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> Ec2QueryListsInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">ListArg:</span><span class="w"> </span><span class="vc">StringList</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">ComplexListArg:</span><span class="w"> </span><span class="vc">GreetingList</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@ec2QueryName</span>(<span class="s2">&quot;Renamed&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nd">@xmlName</span>(<span class="s2">&quot;IgnoreMe&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">RenamedListArg:</span><span class="w"> </span><span class="vc">StringList</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">list</span><span class="nc"> StringList</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">member:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">list</span><span class="nc"> GreetingList</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">member:</span><span class="w"> </span><span class="vc">GreetingStruct</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">structure</span><span class="nc"> GreetingStruct</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">hi:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">application/x-www-form-urlencoded</span></code> serialization is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Action=Ec2QueryLists
&amp;Version=2020-07-02
&amp;ListArg.1=foo
&amp;ListArg.2=bar
&amp;ListArg.3=baz
&amp;ComplexListArg.1.Hi=hello
&amp;ComplexListArg.2.Hi=hola
&amp;Renamed.1=A
&amp;Renamed.2=B
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="response-serialization">
<h2><a href="#response-serialization">Response serialization</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ec2Query</span></code> protocol serializes XML responses within an XML root node with
the name of the operation's output suffixed with &quot;Response&quot;, which contains the
contents of the successful response.</p>
<p>The value of the <code class="docutils literal notranslate"><span class="pre">uri</span></code> member of the <a class="reference internal" href="../core/xml-traits.html#xmlnamespace-trait"><span class="std std-ref">xmlNamespace trait</span></a>
is serialized in an <code class="docutils literal notranslate"><span class="pre">xmlns</span></code> attribute on the response's XML root node. The
following is a sample response to an operation named <code class="docutils literal notranslate"><span class="pre">XmlTest</span></code>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;XmlTestResponse</span> <span class="na">xmlns=</span><span class="s">&quot;https://example.com/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;testValue&gt;</span>Hello!<span class="nt">&lt;/testValue&gt;</span>
<span class="nt">&lt;/XmlTestResponse&gt;</span>
</pre></div>
</div>
<div class="section" id="xml-shape-serialization">
<h3><a href="#xml-shape-serialization">XML shape serialization</a></h3>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Smithy type</th>
<th class="head">XML entity</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">blob</span></code></td>
<td>XML text node with a value that is base64 encoded.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">boolean</span></code></td>
<td>XML text node with a value either &quot;true&quot; or &quot;false&quot;.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">byte</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">short</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">long</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">float</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">double</span></code></td>
<td>XML text node with a value of the number.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">bigDecimal</span></code></td>
<td>XML text node with a value of the number, using scientific notation if
an exponent is needed. Unfortunately, many XML parsers will either
truncate the value or be unable to parse numbers that exceed the size
of a double.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">bigInteger</span></code></td>
<td>XML text node with a value of the number, using scientific notation if
an exponent is needed. Unfortunately, many XML parsers will either
truncate the value or be unable to parse numbers that exceed the size
of a double.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>XML text node with an XML-safe, UTF-8 value of the string.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></td>
<td>XML text node with a value of the timestamp. This protocol uses
<code class="docutils literal notranslate"><span class="pre">date-time</span></code> as the default serialization. However, the
<a class="reference internal" href="../core/protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat</span></a> MAY be used to
customize timestamp serialization.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">document</span></code></td>
<td>Undefined. Document shapes are not supported in this protocol.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">list</span></code></td>
<td>XML element. Each value provided in the list is serialized as a nested
XML element with the name <code class="docutils literal notranslate"><span class="pre">member</span></code>. The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be
used to serialize a property using a custom name. The
<a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened trait</span></a> can be used to unwrap the values into a
containing structure or union, with the value XML element using the
structure or union member name. See <a class="reference internal" href="../core/xml-traits.html#xml-list-and-set-serialization"><span class="std std-ref">List and set serialization</span></a>
for more.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">set</span></code></td>
<td>XML element. A set is serialized identically to a <code class="docutils literal notranslate"><span class="pre">list</span></code> shape,
but only contains unique values.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">map</span></code></td>
<td>XML element. Each key-value pair provided in the map is serialized in
a nested XML element with the name <code class="docutils literal notranslate"><span class="pre">entry</span></code> that contains nested
elements <code class="docutils literal notranslate"><span class="pre">key</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> for the pair. The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a>
can be used to serialize key or value properties using a custom name,
it cannot be used to influence the <code class="docutils literal notranslate"><span class="pre">entry</span></code> name. The
<a class="reference internal" href="../core/xml-traits.html#xmlflattened-trait"><span class="std std-ref">xmlFlattened trait</span></a> can be used to unwrap the entries into a
containing structure or union, with the entry XML element using the
structure or union member name. See <a class="reference internal" href="../core/xml-traits.html#xml-map-serialization"><span class="std std-ref">Map serialization</span></a> for
more.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">structure</span></code></td>
<td>XML element. Each member value provided for the structure is
serialized as a nested XML element where the element name is the
same as the member name. The <a class="reference internal" href="../core/xml-traits.html#xmlname-trait"><span class="std std-ref">xmlName trait</span></a> can be used to
serialize a property using a custom name. The <a class="reference internal" href="../core/xml-traits.html#xmlattribute-trait"><span class="std std-ref">xmlAttribute trait</span></a>
can be used to serialize a property in an attribute of the containing
element. See <a class="reference internal" href="../core/xml-traits.html#xml-structure-and-union-serialization"><span class="std std-ref">Structure and union serialization</span></a> for more.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">union</span></code></td>
<td>XML element. A union is serialized identically to a <code class="docutils literal notranslate"><span class="pre">structure</span></code>
shape, but only a single member can be set to a non-null value.</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">See <a class="reference internal" href="../core/xml-traits.html#serializing-xml-shapes"><span class="std std-ref">Serializing XML shapes</span></a> for comprehensive documentation,
including examples and behaviors when using multiple XML traits.</p>
</div>
</div>
</div>
<div class="section" id="operation-error-serialization">
<span id="ec2query-errors"></span><h2><a href="#operation-error-serialization">Operation error serialization</a></h2>
<p>Error responses in the <code class="docutils literal notranslate"><span class="pre">ec2Query</span></code> protocol are wrapped within an XML root
node named <code class="docutils literal notranslate"><span class="pre">Response</span></code>. Inside this, there is an <code class="docutils literal notranslate"><span class="pre">Errors</span></code> tag containing
the actual error, and a <code class="docutils literal notranslate"><span class="pre">RequestId</span></code> tag holding the request ID. Nested inside
of the <code class="docutils literal notranslate"><span class="pre">Errors</span></code> tag is an <code class="docutils literal notranslate"><span class="pre">Error</span></code> tag which contains the serialized error
structure members.</p>
<p>Serialized error shapes MUST also contain an additional child element <code class="docutils literal notranslate"><span class="pre">Code</span></code>
that contains only the <a class="reference internal" href="../core/model.html#grammar-token-smithy-identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">shape</span> <span class="pre">name</span></code></a> of the error's
<a class="reference internal" href="../core/model.html#shape-id"><span class="std std-ref">Shape ID</span></a>. This can be used to distinguish which specific error has been
serialized in the response.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Response&gt;</span>
    <span class="nt">&lt;Errors&gt;</span>
        <span class="nt">&lt;Error&gt;</span>
            <span class="nt">&lt;Code&gt;</span>InvalidGreeting<span class="nt">&lt;/Code&gt;</span>
            <span class="nt">&lt;Message&gt;</span>Hi<span class="nt">&lt;/Message&gt;</span>
            <span class="nt">&lt;AnotherSetting&gt;</span>setting<span class="nt">&lt;/AnotherSetting&gt;</span>
        <span class="nt">&lt;/Error&gt;</span>
    <span class="nt">&lt;/Errors&gt;</span>
    <span class="nt">&lt;RequestId&gt;</span>foo-id<span class="nt">&lt;/RequestId&gt;</span>
<span class="nt">&lt;/Response&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Code</span></code>: The <a class="reference internal" href="../core/model.html#grammar-token-smithy-identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">shape</span> <span class="pre">name</span></code></a> of the error's
<a class="reference internal" href="../core/model.html#shape-id"><span class="std std-ref">Shape ID</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">RequestId</span></code>: Contains a unique identifier for the associated request.</li>
</ul>
<p>In the above example, <code class="docutils literal notranslate"><span class="pre">Message</span></code>, and <code class="docutils literal notranslate"><span class="pre">AnotherSetting</span></code> are additional,
hypothetical members of the serialized error structure.</p>
</div>
<div class="section" id="non-numeric-float-and-double-serialization">
<span id="ec2query-non-numeric-float-serialization"></span><h2><a href="#non-numeric-float-and-double-serialization">Non-numeric float and double serialization</a></h2>
<p>Smithy floats and doubles are defined by IEEE-754, which includes special values
for &quot;not a number&quot; and both positive and negative infinity. Unless otherwise
specified, the <code class="docutils literal notranslate"><span class="pre">ec2Query</span></code> protocol treats those special values as
strings with the following values:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Special Value</th>
<th class="head">String Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Not a number</td>
<td><code class="docutils literal notranslate"><span class="pre">NaN</span></code></td>
</tr>
<tr class="row-odd"><td>Positive infinity</td>
<td><code class="docutils literal notranslate"><span class="pre">Infinity</span></code></td>
</tr>
<tr class="row-even"><td>Negative infinity</td>
<td><code class="docutils literal notranslate"><span class="pre">-Infinity</span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="protocol-compliance-tests">
<span id="ec2query-compliance-tests"></span><h2><a href="#protocol-compliance-tests">Protocol compliance tests</a></h2>
<p>A full compliance test suite is provided and SHALL be considered a normative
reference: <a class="reference external" href="https://github.com/awslabs/smithy/tree/main/smithy-aws-protocol-tests/model/ec2Query">https://github.com/awslabs/smithy/tree/main/smithy-aws-protocol-tests/model/ec2Query</a></p>
<p>These compliance tests define a model that is used to define test cases and
the expected serialized HTTP requests and responses for each case.</p>
<p><em>TODO: Add specifications, protocol examples, etc.</em></p>
</div>
</div>


                    
                    <section class="relations">
                        
                        <a href="aws-query-protocol.html" title="previous chapter" class="previous-page clearfix hidden-xs">‚Üê AWS query protocol</a>
                        
                        <a href="customizations/index.html" title="next chapter" class="next-page clearfix">AWS Service Customizations ‚Üí</a>
                    </section>
                    
                </article><aside id="right-column" class="side-column hidden-sm">
                    <div class="column-body">
                        <section class="sidebar">
                            
                            <section class="next-previous">
                                
                                <a href="aws-query-protocol.html" title="previous chapter" class="previous-page clearfix hidden-xs">‚Üê Prev</a>
                                
                                <a href="customizations/index.html" title="next chapter" class="next-page clearfix">Next ‚Üí</a>
                            </section>
                            
                            <ul>
<li><a class="reference internal" href="#">AWS EC2 query protocol</a><ul>
<li><a class="reference internal" href="#aws-protocols-ec2query-trait"><code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2Query</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-protocols-ec2queryname-trait"><code class="docutils literal notranslate"><span class="pre">aws.protocols#ec2QueryName</span></code> trait</a><ul>
<li><a class="reference internal" href="#query-key-resolution">Query key resolution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#supported-traits">Supported traits</a></li>
<li><a class="reference internal" href="#request-serialization">Request serialization</a><ul>
<li><a class="reference internal" href="#x-www-form-urlencoded-shape-serialization">x-www-form-urlencoded shape serialization</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#structures-and-unions">Structures and Unions</a></li>
<li><a class="reference internal" href="#collections">Collections</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#response-serialization">Response serialization</a><ul>
<li><a class="reference internal" href="#xml-shape-serialization">XML shape serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operation-error-serialization">Operation error serialization</a></li>
<li><a class="reference internal" href="#non-numeric-float-and-double-serialization">Non-numeric float and double serialization</a></li>
<li><a class="reference internal" href="#protocol-compliance-tests">Protocol compliance tests</a></li>
</ul>
</li>
</ul>

                        </section>
                    </div>
                </aside></div>
        </section>
        
    
<footer id="footer">
    <div class="width-wrapper">
        <div class="copyright">
            <p>¬©2021, Amazon Web Services, Inc or its affiliates. All rights reserved.</p>
        </div>
    </div>
</footer>
  </body>
</html>