
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>11. HTTP binding traits &#8212; Smithy 1.0 documentation</title><link rel="stylesheet" href="../../../_static/bootstrap-reboot.css" type="text/css" />
    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" href="../../../_static/custom-tabs.css" type="text/css" />

    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script type="text/javascript" src="../../../_static/smithy.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="12. XML binding traits" href="xml-traits.html" />
    <link rel="prev" title="10. Streaming Traits" href="stream-traits.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="smithy-version" content="1.0">

  </head><body>
    <header>
        <div class="header-flex width-wrapper">
            <div class="site-logo">
                <a href="../../../index.html">
                    <span class="logo-icon">üî®Ô∏è</span><span class="logo-text">Smithy</span>
                </a>
                <span class="version-text">1.0</span>
            </div>
            <ul id="page-navigation">
                <li class="site-page first"><a href="../../../quickstart.html">Quick Start</a></li>
                <li class="site-page"><a href="../index.html">Specifications</a></li>
                <li class="site-page"><a href="../../guides/index.html">Guides</a></li>
                <li class="site-page"><a href="https://github.com/awslabs/smithy">Code</a></li>
                <li class="site-search hidden-sm">
                    <form action="../../../search.html" method="get">
                        <input type="hidden" name="check_keywords" value="yes" />
                        <input type="hidden" name="area" value="default" />
                        <input class="search-input" autocomplete="off" type="search" name="q" placeholder="Search" />
                    </form>
                </li>
            </ul>
        </div>
    </header>
    
        
        
        <section id="page-container">
            <div class="width-wrapper flex">
                <article class="document-body">
                    
                    <ul class="rel-parents">
                    <li><a href="../index.html" >Specifications</a></li>
                    <li><a href="index.html" accesskey="U">Smithy specification</a></li>
                    </ul>
                    
                    
  <div class="section" id="http-binding-traits">
<span id="http-traits"></span><h1><a href="#http-binding-traits"><span class="section-number">11. </span>HTTP binding traits</a></h1>
<p>Smithy provides various HTTP binding traits that can be used by protocols to
explicitly configure HTTP request and response messages.</p>
<p>The members of an operation input, output, and errors MUST NOT be bound to
multiple HTTP message locations (e.g., a member cannot be bound to both a URI
label and to a header). Only top-level members of an operation's input, output,
and error structures are considered when serializing HTTP messages.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#http-trait" id="id12"><code class="docutils literal notranslate"><span class="pre">http</span></code> trait</a></li>
<li><a class="reference internal" href="#httperror-trait" id="id13"><code class="docutils literal notranslate"><span class="pre">httpError</span></code> trait</a></li>
<li><a class="reference internal" href="#httpheader-trait" id="id14"><code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> trait</a></li>
<li><a class="reference internal" href="#httplabel-trait" id="id15"><code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait</a></li>
<li><a class="reference internal" href="#httppayload-trait" id="id16"><code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait</a></li>
<li><a class="reference internal" href="#httpprefixheaders-trait" id="id17"><code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> trait</a></li>
<li><a class="reference internal" href="#httpquery-trait" id="id18"><code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> trait</a></li>
<li><a class="reference internal" href="#httpqueryparams-trait" id="id19"><code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> trait</a></li>
<li><a class="reference internal" href="#httpresponsecode-trait" id="id20"><code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> trait</a></li>
<li><a class="reference internal" href="#cors-trait" id="id21"><code class="docutils literal notranslate"><span class="pre">cors</span></code> trait</a></li>
<li><a class="reference internal" href="#serializing-http-messages" id="id22">Serializing HTTP messages</a></li>
<li><a class="reference internal" href="#event-streams" id="id23">Event streams</a></li>
</ul>
</div>
<div class="section" id="http-trait">
<span id="smithy-api-http-trait"></span><span id="id1"></span><h2><a href="#http-trait"><span class="section-number">11.1. </span><code class="docutils literal notranslate"><span class="pre">http</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Configures the HTTP bindings of an operation.</dd>
<dt>Trait selector</dt><dd><code class="docutils literal notranslate"><span class="pre">operation</span></code></dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">structure</span></code></dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">http</span></code> trait is a structure that supports the following members:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="10%" />
<col width="25%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="#http-method"><span class="std std-ref">method</span></a></td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required</strong>. The HTTP method of the operation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#http-uri"><span class="std std-ref">uri</span></a></td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required</strong>. The URI pattern of the operation. Labels defined in the
URI pattern are used to bind operation input members to the URI.</td>
</tr>
<tr class="row-even"><td>code</td>
<td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>The HTTP status code of a successful response. Defaults to <code class="docutils literal notranslate"><span class="pre">200</span></code> if
not provided. The provided value SHOULD be between 100 and 599, and
it MUST be between 100 and 999.</td>
</tr>
</tbody>
</table>
<p>The following example defines an operation that uses HTTP bindings:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="nd">@idempotent</span><span class="w"></span>
<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;PUT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/{bucketName}/{key}&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="m">200</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> PutObject</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">PutObjectInput</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> PutObjectInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="c">// Sent in the URI label named &quot;key&quot;.</span><span class="w"></span>
<span class="w">    </span><span class="nd">@required</span><span class="w"></span>
<span class="w">    </span><span class="nd">@httpLabel</span><span class="w"></span>
<span class="w">    </span><span class="nl">key:</span><span class="w"> </span><span class="vc">ObjectKey</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="c">// Sent in the URI label named &quot;bucketName&quot;.</span><span class="w"></span>
<span class="w">    </span><span class="nd">@required</span><span class="w"></span>
<span class="w">    </span><span class="nd">@httpLabel</span><span class="w"></span>
<span class="w">    </span><span class="nl">bucketName:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="c">// Sent in the X-Foo header</span><span class="w"></span>
<span class="w">    </span><span class="nd">@httpHeader</span>(<span class="s2">&quot;X-Foo&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">foo:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="c">// Sent in the query string as paramName</span><span class="w"></span>
<span class="w">    </span><span class="nd">@httpQuery</span>(<span class="s2">&quot;paramName&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">someValue:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="c">// Sent in the body</span><span class="w"></span>
<span class="w">    </span><span class="nl">data:</span><span class="w"> </span><span class="vc">MyBlob</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="c">// Sent in the body</span><span class="w"></span>
<span class="w">    </span><span class="nl">additional:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<div class="section" id="method">
<span id="http-method"></span><h3><a href="#method"><span class="section-number">11.1.1. </span>method</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">method</span></code> property defines the HTTP method of the operation (e.g., &quot;GET&quot;,
&quot;PUT&quot;, &quot;POST&quot;, &quot;DELETE&quot;, &quot;PATCH&quot;, etc). Smithy will use this value literally
and will perform no validation on the method. The <code class="docutils literal notranslate"><span class="pre">method</span></code> value SHOULD
match the <code class="docutils literal notranslate"><span class="pre">operation</span></code> production rule of <span class="target" id="index-0"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7230.html#appendix-B"><strong>RFC 7230#appendix-B</strong></a>. This
property does not influence the safety or idempotency characteristics of an
operation.</p>
</div>
<div class="section" id="uri">
<span id="http-uri"></span><h3><a href="#uri"><span class="section-number">11.1.2. </span>uri</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">uri</span></code> property defines the <em>request-target</em> of the operation in
<em>origin-form</em> as defined in <span class="target" id="index-1"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7230.html#section-5.3.1"><strong>RFC 7230#section-5.3.1</strong></a>. The URI is a simple
pattern that Smithy uses to match HTTP requests to operations and to bind
components of the request URI to fields in the operations's input structure.
<em class="dfn">Patterns</em> consist of literal characters that MUST be matched in the
request URI and labels which are used to insert named components into the
request URI.</p>
<p>The resolved absolute URI of an operation is formed by combining the URI of
the operation with the endpoint of the service. (that is, the host and any
base URL of where the service is deployed). For example, given a service
endpoint of <code class="docutils literal notranslate"><span class="pre">https://example.com/v1</span></code> and an operation pattern of
<code class="docutils literal notranslate"><span class="pre">/myresource</span></code>, the resolved absolute URI of the operation is
<code class="docutils literal notranslate"><span class="pre">https://example.com/v1/myresource</span></code>.</p>
<p>The value provided for the <code class="docutils literal notranslate"><span class="pre">uri</span></code> property MUST adhere to the following
constraints:</p>
<ol class="arabic simple">
<li>MUST start with &quot;/&quot;.</li>
<li>MUST NOT contain empty path segments (i.e., &quot;//&quot;).</li>
<li>MUST NOT contain a fragment (i.e., &quot;#&quot;).</li>
<li>MUST NOT end with &quot;?&quot;.</li>
<li>MUST NOT contain dot-segments (i.e., &quot;..&quot; and &quot;.&quot;).</li>
<li>MUST NOT case-sensitively conflict with other <code class="docutils literal notranslate"><span class="pre">http</span></code> / <code class="docutils literal notranslate"><span class="pre">uri</span></code>
properties.</li>
</ol>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@readonly</span><span class="w"></span>
<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/foo/{baz}&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> GetService</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">output:</span><span class="w"> </span><span class="vc">GetServiceOutput</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<div class="section" id="literal-character-sequences">
<h4><a href="#literal-character-sequences"><span class="section-number">11.1.2.1. </span>Literal character sequences</a></h4>
<p>Patterns with no labels will match only requests containing the exact literal
characters declared in the pattern, with the exception of trailing slashes
which are always optional.</p>
<p>Given an endpoint of <code class="docutils literal notranslate"><span class="pre">https://yourhost</span></code> and a pattern of <code class="docutils literal notranslate"><span class="pre">/my/uri/path</span></code>:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="40%" />
<col width="10%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Request URI</th>
<th class="head">Matches?</th>
<th class="head">Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">https://yourhost/my/uri/path</span></code></td>
<td>Yes</td>
<td>Exact match</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">https://yourhost/my/uri/path/</span></code></td>
<td>Yes</td>
<td>Trailing slashes are ignored</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">https://yourhost/my/uri</span></code></td>
<td>No</td>
<td>Missing &quot;/path&quot;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">https://yourhost/my/uri/other</span></code></td>
<td>No</td>
<td>Found &quot;/other&quot; instead of &quot;/path&quot;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">https://yourhost/my/uri/path/other</span></code></td>
<td>No</td>
<td>Trailing segment &quot;/other&quot;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="labels">
<span id="http-uri-label"></span><h4><a href="#labels"><span class="section-number">11.1.2.2. </span>Labels</a></h4>
<p>Patterns MAY contain label placeholders in the path. <em class="dfn">Labels</em> consist of
label name characters surrounded by open and closed braces (i.e.,
&quot;{label_name}&quot; is a label and <code class="docutils literal notranslate"><span class="pre">label_name</span></code> is the label name). The label
name corresponds to a top-level operation input structure member name. Every
label MUST have a corresponding input member, the input member MUST be marked
as <a class="reference internal" href="constraint-traits.html#required-trait"><span class="std std-ref">required trait</span></a>, the input member MUST have the <a class="reference internal" href="#httplabel-trait"><span class="std std-ref">httpLabel trait</span></a>,
and the input member MUST reference a string, byte, short, integer, long,
float, double, bigDecimal, bigInteger, boolean, or timestamp. Labels only
capture path segments.</p>
<p>Labels MUST adhere to the following constraints:</p>
<ol class="arabic simple">
<li>Labels MUST NOT appear in the query string.</li>
<li>Each label MUST span an entire path segment (e.g., &quot;/{foo}/bar&quot; is valid,
and &quot;/{foo}bar&quot; is invalid).</li>
</ol>
<p>A pattern of <code class="docutils literal notranslate"><span class="pre">/my/uri/{label}</span></code> will match any URI that begins with
<code class="docutils literal notranslate"><span class="pre">/my/uri/</span></code> followed by any string not including an additional path segment
(&quot;/&quot;).</p>
<p>Given a pattern of <code class="docutils literal notranslate"><span class="pre">/my/uri/{label}</span></code> and an endpoint of <code class="docutils literal notranslate"><span class="pre">http://yourhost</span></code>:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="40%" />
<col width="10%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Request URI</th>
<th class="head">Matches?</th>
<th class="head">Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo</span></code></td>
<td>Yes</td>
<td>&quot;/my/uri/&quot; matches and &quot;foo&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo/</span></code></td>
<td>Yes</td>
<td>&quot;/my/uri/&quot; matches and &quot;foo&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label</span></code>. The trailing
&quot;/&quot; is ignored.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo?query=bar</span></code></td>
<td>Yes</td>
<td>&quot;/my/uri/&quot; matches and &quot;foo&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo#bar</span></code></td>
<td>Yes</td>
<td>&quot;/my/uri/&quot; matches and &quot;foo&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/bar</span></code></td>
<td>Yes</td>
<td>&quot;/my/uri/&quot; matches and &quot;bar&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri</span></code></td>
<td>No</td>
<td>&quot;/my/uri&quot; matches but is missing a segment for <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo/bar</span></code></td>
<td>No</td>
<td>Found a trailing segment &quot;/bar&quot;.</td>
</tr>
</tbody>
</table>
<p>Any number of labels can be included within a pattern, provided that they are
not immediately adjacent and do not have identical label names. Given a
pattern of <code class="docutils literal notranslate"><span class="pre">/my/uri/{label1}/{label2}</span></code> and an endpoint of
<code class="docutils literal notranslate"><span class="pre">http://yourhost</span></code>:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="40%" />
<col width="10%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Request URI</th>
<th class="head">Matches?</th>
<th class="head">Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo/bar</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/my/uri/&quot;, &quot;foo&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label1</span></code>, and &quot;bar&quot;
is captured as <code class="docutils literal notranslate"><span class="pre">label2</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/bar/baz/</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/my/uri/&quot;, &quot;bar&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label1</span></code>, and &quot;baz&quot;
is captured as <code class="docutils literal notranslate"><span class="pre">label2</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo</span></code></td>
<td>No</td>
<td>Matches literal &quot;/my/uri/&quot; but is missing a segment for <code class="docutils literal notranslate"><span class="pre">label2</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri</span></code></td>
<td>No</td>
<td>Matches literal &quot;/my/uri/&quot; but is missing segments for <code class="docutils literal notranslate"><span class="pre">label1</span></code> and
<code class="docutils literal notranslate"><span class="pre">label2</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo/bar/baz</span></code></td>
<td>No</td>
<td>Matches literal &quot;/my/uri/&quot;, &quot;bar&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label1</span></code>, and &quot;baz&quot;
is captured as <code class="docutils literal notranslate"><span class="pre">label2</span></code>, but contains an additional segment &quot;baz&quot;.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="query-string-literals">
<h4><a href="#query-string-literals"><span class="section-number">11.1.2.3. </span>Query string literals</a></h4>
<p>Components of the query string can be matched literally in the URI pattern.
The query string portion of a pattern MUST NOT contain labels.</p>
<p>Literals can be in the form of required keys without values. Given a pattern
of <code class="docutils literal notranslate"><span class="pre">/path?requiredKey</span></code> and an endpoint of <code class="docutils literal notranslate"><span class="pre">http://yourhost</span></code>:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="40%" />
<col width="10%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Request URI</th>
<th class="head">Matches?</th>
<th class="head">Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path?requiredKey</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/path&quot; and contains a &quot;requiredKey&quot; query string
parameter.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path?other&amp;requiredKey</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/path&quot; and contains a &quot;requiredKey&quot; query string
parameter.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path</span></code></td>
<td>No</td>
<td>Matches literal &quot;/path&quot; but does not contain the &quot;requiredKey&quot; query
string parameter.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path?</span></code></td>
<td>No</td>
<td>Matches literal &quot;/path&quot; but does not contain the &quot;requiredKey&quot; query
string parameter.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path?otherKey</span></code></td>
<td>No</td>
<td>Matches literal &quot;/path&quot; but does not contain the &quot;requiredKey&quot; query
string parameter.</td>
</tr>
</tbody>
</table>
<p>Literal query string parameters can be matched with required key-value pairs.
Given a pattern of <code class="docutils literal notranslate"><span class="pre">/path?requiredKey=requiredValue</span></code> and an endpoint of
<code class="docutils literal notranslate"><span class="pre">http://yourhost</span></code>:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="40%" />
<col width="10%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Request URI</th>
<th class="head">Matches?</th>
<th class="head">Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path?requiredKey=requiredValue</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/path&quot; and contains a query string parameter named
&quot;requiredKey&quot; with a value of &quot;requiredValue&quot;.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path?other&amp;requiredKey=requiredValue</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/path&quot; and contains a query string parameter named
&quot;requiredKey&quot; with a value of &quot;requiredValue&quot;. &quot;other&quot; is disregarded
or bound to another input member.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path</span></code></td>
<td>No</td>
<td>Does not contain a query string parameter named &quot;requiredKey&quot;.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path?</span></code></td>
<td>No</td>
<td>Does not contain a query string parameter named &quot;requiredKey&quot;.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/path?requiredKey=otherValue</span></code></td>
<td>No</td>
<td>Contains a query string parameter named &quot;requiredKey&quot; but its value
is not &quot;requiredValue&quot;.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="greedy-labels">
<span id="id2"></span><h4><a href="#greedy-labels"><span class="section-number">11.1.2.4. </span>Greedy labels</a></h4>
<p>A <em class="dfn">greedy label</em> is a label suffixed with the <code class="docutils literal notranslate"><span class="pre">+</span></code> qualifier that can be
used to match more than one path segment. At most, one greedy label may exist
in any path pattern, and if present, it MUST be the last label in the pattern.
Greedy labels MUST be bound to a string shape.</p>
<p>Given a pattern of <code class="docutils literal notranslate"><span class="pre">/my/uri/{label+}</span></code> and an endpoint of <code class="docutils literal notranslate"><span class="pre">http://yourhost</span></code>:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="40%" />
<col width="10%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Request URI</th>
<th class="head">Matches?</th>
<th class="head">Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo/bar</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/my/uri/&quot;, and &quot;foo/bar&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/bar/baz/</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/my/uri/&quot;, and &quot;bar/baz&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri/foo/bar/baz</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/my/uri/&quot;, and &quot;foo/bar/baz&quot; is captured as <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/my/uri</span></code></td>
<td>No</td>
<td>Matches literal &quot;/my/uri/&quot; but does not contain a segment to match
<code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
</tbody>
</table>
<p>Greedy matching can be used to capture the whole URI to a label, which results
in every request for a particular HTTP method being captured. For example, this
can be modeled with a pattern of <code class="docutils literal notranslate"><span class="pre">/{label+}</span></code>.</p>
<p>Segments in the middle of a URI can be captured using greedy labels. Greedy
labels match greedily: they will match the longest possible string. Given a
pattern of <code class="docutils literal notranslate"><span class="pre">/prefix/{label+}/suffix</span></code> and an endpoint of <code class="docutils literal notranslate"><span class="pre">https://yourhost</span></code>:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="40%" />
<col width="10%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Request URI</th>
<th class="head">Matches?</th>
<th class="head">Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/prefix/foo/suffix</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/prefix&quot;, captures &quot;foo&quot; in greedy <code class="docutils literal notranslate"><span class="pre">label</span></code>, and
matches literal &quot;/suffix&quot;.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/prefix/foo/bar/suffix</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/prefix&quot;, captures &quot;foo/bar&quot; in greedy <code class="docutils literal notranslate"><span class="pre">label</span></code>, and
matches literal &quot;/suffix&quot;.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/prefix/foo/bar</span></code></td>
<td>No</td>
<td>Matches literal &quot;/prefix&quot;, but does not contain the trailing literal
&quot;/suffix&quot;.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/foo/bar/suffix</span></code></td>
<td>No</td>
<td>Does not match the literal &quot;/prefix&quot;.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/prefix/foo/suffix/bar/suffix</span></code></td>
<td>Yes</td>
<td>Matches literal &quot;/prefix&quot;, captures &quot;foo/suffix/bar&quot; in greedy
<code class="docutils literal notranslate"><span class="pre">label</span></code>, and matches literal &quot;/suffix&quot;.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">http://yourhost/prefix/suffix</span></code></td>
<td>No</td>
<td>Matches literal &quot;/prefix&quot;, matches literal &quot;/suffix&quot;, but does not
contain a segment to match <code class="docutils literal notranslate"><span class="pre">label</span></code>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pattern-validation-and-conflict-avoidance">
<h4><a href="#pattern-validation-and-conflict-avoidance"><span class="section-number">11.1.2.5. </span>Pattern Validation and Conflict Avoidance</a></h4>
<p>Smithy validates the patterns within a service against each other to ensure
that no two patterns conflict with each other for the same HTTP method. To
prevent ambiguity when matching requests for different operations, the
following rules are in place:</p>
<ol class="arabic simple">
<li>All labels MUST be delimited by '/' characters.<ul>
<li><code class="docutils literal notranslate"><span class="pre">/{foo}/{bar}</span></code> is legal</li>
<li><code class="docutils literal notranslate"><span class="pre">/{foo}{bar}</span></code> is illegal</li>
<li><code class="docutils literal notranslate"><span class="pre">/{foo}bar/{bar}</span></code> is illegal</li>
<li><code class="docutils literal notranslate"><span class="pre">/{foo}a{bar}</span></code> is illegal</li>
</ul>
</li>
<li>At most, one greedy label MAY exist per pattern.<ul>
<li><code class="docutils literal notranslate"><span class="pre">/{foo}/{bar+}</span></code> is legal</li>
<li><code class="docutils literal notranslate"><span class="pre">/{foo+}/{bar+}</span></code> is illegal</li>
</ul>
</li>
<li>If present, a greedy pattern MUST be the last label in a pattern.<ul>
<li><code class="docutils literal notranslate"><span class="pre">/{foo}/{bar+}</span></code> is legal</li>
<li><code class="docutils literal notranslate"><span class="pre">/{foo+}/{bar}</span></code> is illegal</li>
</ul>
</li>
<li>Patterns MUST NOT be equivalent if they share a host.<ul>
<li>Pattern <code class="docutils literal notranslate"><span class="pre">/foo/bar</span></code> and <code class="docutils literal notranslate"><span class="pre">/foo/bar</span></code> conflict.</li>
<li>Pattern <code class="docutils literal notranslate"><span class="pre">/foo/{bar}</span></code> and <code class="docutils literal notranslate"><span class="pre">/foo/{baz}</span></code> conflict regardless of any
constraint traits on the label members.</li>
</ul>
</li>
<li>A label and a literal SHOULD NOT both occupy the same segment in patterns
which are equivalent to that point if they share a host.<ul>
<li><code class="docutils literal notranslate"><span class="pre">/foo/bar/{baz}</span></code> and <code class="docutils literal notranslate"><span class="pre">/foo/baz/bam</span></code> can coexist.</li>
<li><code class="docutils literal notranslate"><span class="pre">/foo/bar</span></code> and <code class="docutils literal notranslate"><span class="pre">/foo/{baz}/bam</span></code> cannot coexist unless pattern
traits prevent <code class="docutils literal notranslate"><span class="pre">{baz}</span></code> from evaluating to <code class="docutils literal notranslate"><span class="pre">bar</span></code> because the label
occupies the same segment of another pattern with the same prefix.</li>
</ul>
</li>
<li>A query string literal with no value and a query string literal with an
empty value are considered equivalent. For example, <code class="docutils literal notranslate"><span class="pre">/foo?baz</span></code> and
<code class="docutils literal notranslate"><span class="pre">/foo?baz=</span></code> are considered the same route.</li>
<li>Patterns MAY conflict if the operations use different hosts. Different hosts
can be configured using the <a class="reference internal" href="endpoint-traits.html#endpoint-trait"><span class="std std-ref">endpoint trait</span></a>'s <code class="docutils literal notranslate"><span class="pre">hostPrefix</span></code> property.<ul>
<li><code class="docutils literal notranslate"><span class="pre">/foo/bar</span></code> and <code class="docutils literal notranslate"><span class="pre">/foo/{baz}/bam</span></code> can coexist if one operation has no
endpoint trait and the other specifies <code class="docutils literal notranslate"><span class="pre">foo.</span></code> as the <code class="docutils literal notranslate"><span class="pre">hostPrefix</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">/foo/bar</span></code> and <code class="docutils literal notranslate"><span class="pre">/foo/{baz}/bam</span></code> can coexist if one operation specifies
<code class="docutils literal notranslate"><span class="pre">foo.</span></code> as the <code class="docutils literal notranslate"><span class="pre">hostPrefix</span></code> and the other specifies <code class="docutils literal notranslate"><span class="pre">bar.</span></code> as the
<code class="docutils literal notranslate"><span class="pre">hostPrefix</span></code>.</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="httperror-trait">
<span id="smithy-api-httperror-trait"></span><span id="id3"></span><h2><a href="#httperror-trait"><span class="section-number">11.2. </span><code class="docutils literal notranslate"><span class="pre">httpError</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Defines an HTTP response code for an operation error.</dd>
<dt>Trait selector</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>structure[trait|error]
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">httpError</span></code> trait can only be applied to <a class="reference internal" href="model.html#structure"><span class="std std-ref">structure</span></a>
shapes that also have the <a class="reference internal" href="type-refinement-traits.html#error-trait"><span class="std std-ref">error trait</span></a>.</p>
</dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">integer</span></code> value representing the HTTP response status code
(for example, <code class="docutils literal notranslate"><span class="pre">404</span></code>).</dd>
</dl>
<p>The following example defines an error with an HTTP status code of <code class="docutils literal notranslate"><span class="pre">404</span></code>.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@error</span>(<span class="s2">&quot;client&quot;</span>)<span class="w"></span>
<span class="nd">@httpError</span>(<span class="m">404</span>)<span class="w"></span>
<span class="kd">structure</span><span class="nc"> MyError</span><span class="w"> </span>{}<span class="w"></span>
</pre></div>
</div>
<p class="rubric">Default HTTP status codes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">httpError</span></code> trait is used to set a <em>custom</em> HTTP response status code.
By default, error structures with no <code class="docutils literal notranslate"><span class="pre">httpError</span></code> trait use the default
HTTP status code of the <a class="reference internal" href="type-refinement-traits.html#error-trait"><span class="std std-ref">error trait</span></a>.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">400</span></code> is used for &quot;client&quot; errors</li>
<li><code class="docutils literal notranslate"><span class="pre">500</span></code> is used for &quot;server&quot; errors</li>
</ul>
</div>
<div class="section" id="httpheader-trait">
<span id="smithy-api-httpheader-trait"></span><span id="id4"></span><h2><a href="#httpheader-trait"><span class="section-number">11.3. </span><code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Binds a structure member to an HTTP header.</dd>
<dt>Trait selector</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>structure &gt; :test(member &gt; :test(boolean, number, string, timestamp,
        collection &gt; member &gt; :test(boolean, number, string, timestamp)))
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> trait can be applied to <code class="docutils literal notranslate"><span class="pre">structure</span></code> members that
target a <code class="docutils literal notranslate"><span class="pre">boolean</span></code>, <code class="docutils literal notranslate"><span class="pre">number</span></code>, <code class="docutils literal notranslate"><span class="pre">string</span></code>, or <code class="docutils literal notranslate"><span class="pre">timestamp</span></code>; or a
<code class="docutils literal notranslate"><span class="pre">structure</span></code> member that targets a list/set of these types.</p>
</dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">string</span></code> value defining a valid HTTP header field name according to
<span class="target" id="index-2"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7230.html#section-3.2"><strong>section 3.2 of RFC7230</strong></a>. The value MUST NOT be
empty and MUST be case-insensitively unique across all other members of
the structure.</dd>
<dt>Conflicts with</dt><dd><a class="reference internal" href="#httplabel-trait"><span class="std std-ref">httpLabel trait</span></a>,
<a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>,
<a class="reference internal" href="#httpqueryparams-trait"><span class="std std-ref">httpQueryParams trait</span></a>,
<a class="reference internal" href="#httpprefixheaders-trait"><span class="std std-ref">httpPrefixHeaders trait</span></a>,
<a class="reference internal" href="#httppayload-trait"><span class="std std-ref">httpPayload trait</span></a>,
<a class="reference internal" href="#httpresponsecode-trait"><span class="std std-ref">httpResponseCode trait</span></a></dd>
</dl>
<p class="rubric"><code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> serialization rules:</p>
<ul class="simple">
<li>When a <a class="reference internal" href="model.html#list"><span class="std std-ref">list</span></a> shape is targeted, each member of the shape is
serialized as a separate HTTP header either by concatenating the values
with a comma on a single line or by serializing each header value on its
own line.</li>
<li><code class="docutils literal notranslate"><span class="pre">boolean</span></code> values are serialized as <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">string</span></code> values with a <a class="reference internal" href="protocol-traits.html#mediatype-trait"><span class="std std-ref">mediaType trait</span></a> are always base64 encoded.</li>
<li><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> values are serialized using the <code class="docutils literal notranslate"><span class="pre">http-date</span></code>
format by default, as defined in the <code class="docutils literal notranslate"><span class="pre">IMF-fixdate</span></code> production of
<span class="target" id="index-3"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7231.html#section-7.1.1.1"><strong>RFC 7231#section-7.1.1.1</strong></a>. The <a class="reference internal" href="protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat trait</span></a> MAY be used
to use a custom serialization format.</li>
</ul>
<p class="rubric">Do not put too much data in HTTP headers</p>
<p>While there is no limit placed on the length of an HTTP header field, many
HTTP client and server implementations enforce limits in practice.
Carefully consider the maximum allowed length of each member that is bound
to an HTTP header.</p>
<div class="section" id="restricted-http-headers">
<span id="restricted-headers"></span><h3><a href="#restricted-http-headers"><span class="section-number">11.3.1. </span>Restricted HTTP headers</a></h3>
<p>Various HTTP headers are highly discouraged for the <code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> and
<code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> traits.</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Header</th>
<th class="head">Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Authorization</td>
<td>This header should be populated by
<a class="reference internal" href="auth-traits.html#authdefinition-trait"><span class="std std-ref">authentication traits</span></a>.</td>
</tr>
<tr class="row-odd"><td>Connection</td>
<td>This is controlled at a lower level by the HTTP client or server.</td>
</tr>
<tr class="row-even"><td>Content-Length</td>
<td>HTTP clients and servers are responsible for providing a
Content-Length header.</td>
</tr>
<tr class="row-odd"><td>Expect</td>
<td>This is controlled at a lower level by the HTTP client.</td>
</tr>
<tr class="row-even"><td>Host</td>
<td>The Host header is controlled by the HTTP client, not the model.</td>
</tr>
<tr class="row-odd"><td>Max-Forwards</td>
<td>This is controlled at a lower level by the HTTP client.</td>
</tr>
<tr class="row-even"><td>Proxy-Authenticate</td>
<td>This header should be populated by
<a class="reference internal" href="auth-traits.html#authdefinition-trait"><span class="std std-ref">authentication traits</span></a>.</td>
</tr>
<tr class="row-odd"><td>Server</td>
<td>The Server header is controlled by the HTTP server, not the model.</td>
</tr>
<tr class="row-even"><td>TE</td>
<td>This is controlled at a lower level by the HTTP client and server.</td>
</tr>
<tr class="row-odd"><td>Trailer</td>
<td>This is controlled at a lower level by the HTTP client and server.</td>
</tr>
<tr class="row-even"><td>Transfer-Encoding</td>
<td>This is controlled at a lower level by the HTTP client and server.</td>
</tr>
<tr class="row-odd"><td>Upgrade</td>
<td>This is controlled at a lower level by the HTTP server.</td>
</tr>
<tr class="row-even"><td>User-Agent</td>
<td>Setting a User-Agent is the responsibility of an HTTP client.</td>
</tr>
<tr class="row-odd"><td>WWW-Authenticate</td>
<td>This header should be populated by
<a class="reference internal" href="auth-traits.html#authdefinition-trait"><span class="std std-ref">authentication traits</span></a>.</td>
</tr>
<tr class="row-even"><td>X-Forwarded-For</td>
<td>X-Forwarded-For is an implementation detail of HTTP that does not
need to be modeled.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="httplabel-trait">
<span id="smithy-api-httplabel-trait"></span><span id="id5"></span><h2><a href="#httplabel-trait"><span class="section-number">11.4. </span><code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Binds an operation input structure member to an
<a class="reference internal" href="#http-uri-label"><span class="std std-ref">HTTP label</span></a> so that it is used as part of an
HTTP request URI.</dd>
<dt>Trait selector</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>structure &gt; member[trait|required] :test(&gt; :test(string, number, boolean, timestamp))
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait can be applied to <code class="docutils literal notranslate"><span class="pre">structure</span></code> members marked
with the <a class="reference internal" href="constraint-traits.html#required-trait"><span class="std std-ref">required trait</span></a> that target a <code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">number</span></code>,
<code class="docutils literal notranslate"><span class="pre">boolean</span></code>, or <code class="docutils literal notranslate"><span class="pre">timestamp</span></code>.</p>
</dd>
<dt>Value type</dt><dd>Annotation trait.</dd>
<dt>Conflicts with</dt><dd><a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>,
<a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>,
<a class="reference internal" href="#httpqueryparams-trait"><span class="std std-ref">httpQueryParams trait</span></a>,
<a class="reference internal" href="#httpprefixheaders-trait"><span class="std std-ref">httpPrefixHeaders trait</span></a>,
<a class="reference internal" href="#httppayload-trait"><span class="std std-ref">httpPayload trait</span></a>,
<a class="reference internal" href="#httpresponsecode-trait"><span class="std std-ref">httpResponseCode trait</span></a></dd>
</dl>
<p>The following example defines an operation that send an HTTP label named
<code class="docutils literal notranslate"><span class="pre">foo</span></code> as part of the URI of an HTTP request:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="nd">@readonly</span><span class="w"></span>
<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/{foo}&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> GetStatus</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">GetStatusInput</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">output:</span><span class="w"> </span><span class="vc">GetStatusOutput</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> GetStatusInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@required</span><span class="w"></span>
<span class="w">    </span><span class="nd">@httpLabel</span><span class="w"></span>
<span class="w">    </span><span class="nl">foo:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p class="rubric">Relationship to <a class="reference internal" href="#http-trait"><span class="std std-ref">http trait</span></a></p>
<p>When a structure is used as the input of an operation, any member of the
structure with the <code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait MUST have a corresponding
<a class="reference internal" href="#http-uri-label"><span class="std std-ref">URI label</span></a> with the same name as the member.
<code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> traits are ignored when serializing operation output or errors.</p>
<p class="rubric">Applying the <code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait to members</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> can only be applied to structure members that are marked as
<a class="reference internal" href="constraint-traits.html#required-trait"><span class="std std-ref">required</span></a>.</li>
<li>If the corresponding URI label in the operation is not greedy, then the
<code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait MUST target a member that targets a <code class="docutils literal notranslate"><span class="pre">string</span></code>,
<code class="docutils literal notranslate"><span class="pre">byte</span></code>, <code class="docutils literal notranslate"><span class="pre">short</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code>, <code class="docutils literal notranslate"><span class="pre">long</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>,
<code class="docutils literal notranslate"><span class="pre">bigDecimal</span></code>, <code class="docutils literal notranslate"><span class="pre">bigInteger</span></code>, <code class="docutils literal notranslate"><span class="pre">boolean</span></code>, or <code class="docutils literal notranslate"><span class="pre">timestamp</span></code>.</li>
<li>If the corresponding URI label in the operation is greedy, then the
<code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait MUST target a member that targets a <code class="docutils literal notranslate"><span class="pre">string</span></code> shape.</li>
</ul>
<p class="rubric"><code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> serialization rules:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">boolean</span></code> values are serialized as <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> values are serialized as an <span class="target" id="index-4"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc3339.html"><strong>RFC 3339</strong></a> string by default
(for example, <code class="docutils literal notranslate"><span class="pre">1985-04-12T23:20:50.52Z</span></code>, and with percent-encoding,
<code class="docutils literal notranslate"><span class="pre">1985-04-12T23%3A20%3A50.52Z</span></code>). The <a class="reference internal" href="protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat trait</span></a>
MAY be used to use a custom serialization format.</li>
<li>Reserved characters defined in <span class="target" id="index-5"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc3986.html#section-2.2"><strong>section 2.2 of RFC3986</strong></a>
and the <cite>%</cite> itself MUST be <a class="reference external" href="https://tools.ietf.org/html/rfc3986#section-2.1">percent-encoded</a> (that is, <code class="docutils literal notranslate"><span class="pre">:/?#[]&#64;!$&amp;'()*+,;=%</span></code>).</li>
<li>However, if the label is greedy, then &quot;/&quot; MUST NOT be percent-encoded
because greedy labels are meant to span multiple path segments.</li>
</ul>
<p class="rubric"><code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> is only used on input</p>
<p><code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> is ignored when resolving the HTTP bindings of an operation's
output or an error. This means that if a structure that contains members
marked with the <code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait is used as the top-level output structure
of an operation, then those members are sent as part of the
<a class="reference internal" href="#http-protocol-document-payloads"><span class="std std-ref">protocol-specific document</span></a> sent in
the body of the response.</p>
</div>
<div class="section" id="httppayload-trait">
<span id="smithy-api-httppayload-trait"></span><span id="id6"></span><h2><a href="#httppayload-trait"><span class="section-number">11.5. </span><code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Binds a single structure member to the body of an HTTP message.</dd>
<dt>Trait selector</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>structure &gt; :test(member &gt; :test(string, blob, structure, union, document, list, set, map))
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait can be applied to <code class="docutils literal notranslate"><span class="pre">structure</span></code> members that
target a <code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">blob</span></code>, <code class="docutils literal notranslate"><span class="pre">structure</span></code>, <code class="docutils literal notranslate"><span class="pre">union</span></code>, <code class="docutils literal notranslate"><span class="pre">document</span></code>,
<code class="docutils literal notranslate"><span class="pre">set</span></code>, <code class="docutils literal notranslate"><span class="pre">map</span></code>, or <code class="docutils literal notranslate"><span class="pre">list</span></code>.</p>
</dd>
<dt>Value type</dt><dd>Annotation trait.</dd>
<dt>Conflicts with</dt><dd><a class="reference internal" href="#httplabel-trait"><span class="std std-ref">httpLabel trait</span></a>, <a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>, <a class="reference internal" href="#httpqueryparams-trait"><span class="std std-ref">httpQueryParams trait</span></a>,
<a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>, <a class="reference internal" href="#httpprefixheaders-trait"><span class="std std-ref">httpPrefixHeaders trait</span></a>,
<a class="reference internal" href="#httpresponsecode-trait"><span class="std std-ref">httpResponseCode trait</span></a></dd>
<dt>Structurally exclusive</dt><dd>Only a single structure member can be bound to <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code>.</dd>
</dl>
<p>The following example defines an operation that returns a <code class="docutils literal notranslate"><span class="pre">blob</span></code> of binary
data in a response:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="nd">@readonly</span><span class="w"></span>
<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/random-binary-data&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> GetRandomBinaryData</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">GetRandomBinaryDataInput</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">output:</span><span class="w"> </span><span class="vc">GetRandomBinaryDataOutput</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> GetRandomBinaryDataInput</span><span class="w"> </span>{}<span class="w"></span>

<span class="nd">@output</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> GetRandomBinaryDataOutput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@required</span><span class="w"></span>
<span class="w">    </span><span class="nd">@httpHeader</span>(<span class="s2">&quot;Content-Type&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">contentType:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@httpPayload</span><span class="w"></span>
<span class="w">    </span><span class="nl">content:</span><span class="w"> </span><span class="vc">Blob</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p class="rubric" id="http-protocol-document-payloads">Protocol-specific document payloads</p>
<p>By default, all structure members that are not bound as part of the HTTP
message are serialized in a protocol-specific document sent in the body of
the message (e.g., a JSON object). The <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait can be used to
bind a single top-level operation input, output, or error structure member to
the body of the HTTP message. Multiple members of the same structure MUST NOT
be bound to <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code>.</p>
<p class="rubric">Binding members to <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code></p>
<p>If the <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait is present on the structure referenced by the
input of an operation, then all other structure members MUST be bound with
the <a class="reference internal" href="#httplabel-trait"><span class="std std-ref">httpLabel trait</span></a>, <a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>,
<a class="reference internal" href="#httpprefixheaders-trait"><span class="std std-ref">httpPrefixHeaders trait</span></a>, <a class="reference internal" href="#httpqueryparams-trait"><span class="std std-ref">httpQueryParams trait</span></a>, or <a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait is present on the structure referenced by the
output of an operation or a structure targeted by the <a class="reference internal" href="type-refinement-traits.html#error-trait"><span class="std std-ref">error trait</span></a>,
then all other structure members MUST be bound to a <a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>
or <a class="reference internal" href="#httpprefixheaders-trait"><span class="std std-ref">httpPrefixHeaders trait</span></a>.</p>
<p class="rubric">Serialization rules</p>
<ol class="arabic simple">
<li>When a string or blob member is referenced, the raw value is serialized
as the body of the message.</li>
<li>When a <a class="reference internal" href="model.html#structure"><span class="std std-ref">structure</span></a>, <a class="reference internal" href="model.html#union"><span class="std std-ref">union</span></a>, <a class="reference internal" href="model.html#list"><span class="std std-ref">list</span></a>,
<a class="reference internal" href="model.html#set"><span class="std std-ref">set</span></a>, <a class="reference internal" href="model.html#map"><span class="std std-ref">map</span></a>, or document type is targeted,
the shape value is serialized as a <a class="reference internal" href="protocol-traits.html#protocoldefinition-trait"><span class="std std-ref">protocol-specific</span></a>
document that is sent as the body of the message.</li>
</ol>
</div>
<div class="section" id="httpprefixheaders-trait">
<span id="smithy-api-httpprefixheaders-trait"></span><span id="id7"></span><h2><a href="#httpprefixheaders-trait"><span class="section-number">11.6. </span><code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Binds a map of key-value pairs to prefixed HTTP headers.</dd>
<dt>Trait selector</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>structure &gt; member
:test(&gt; map &gt; member[id|member=value] &gt; string)
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> trait can be applied to <code class="docutils literal notranslate"><span class="pre">structure</span></code> members
that target a <code class="docutils literal notranslate"><span class="pre">map</span></code> of <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
</dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">string</span></code> value that defines the prefix to prepend to each header field
name stored in the targeted map member. For example, given a prefix value
of &quot;X-Amz-Meta-&quot; and a map key entry of &quot;Baz&quot;, the resulting header field
name serialized in the message is &quot;X-Amz-Meta-Baz&quot;.</dd>
<dt>Conflicts with</dt><dd><a class="reference internal" href="#httplabel-trait"><span class="std std-ref">httpLabel trait</span></a>, <a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>, <a class="reference internal" href="#httpqueryparams-trait"><span class="std std-ref">httpQueryParams trait</span></a>,
<a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>, <a class="reference internal" href="#httppayload-trait"><span class="std std-ref">httpPayload trait</span></a>,
<a class="reference internal" href="#httpresponsecode-trait"><span class="std std-ref">httpResponseCode trait</span></a></dd>
<dt>Structurally exclusive</dt><dd>Only a single structure member can be bound to <code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code>.</dd>
</dl>
<p>Given the following Smithy model:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@readonly</span><span class="w"></span>
<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/myOperation&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> MyOperation</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">MyOperationInput</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> MyOperationInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@httpPrefixHeaders</span>(<span class="s2">&quot;X-Foo-&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">headers:</span><span class="w"> </span><span class="vc">StringMap</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">map</span><span class="nc"> StringMap</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">key:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">value:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p>And given the following input to <code class="docutils literal notranslate"><span class="pre">MyOperation</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;first&quot;</span><span class="p">:</span> <span class="s2">&quot;hi&quot;</span><span class="p">,</span>
        <span class="nt">&quot;second&quot;</span><span class="p">:</span> <span class="s2">&quot;there&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An example HTTP request would be serialized as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GET</span> <span class="o">/</span><span class="n">myOperation</span>
<span class="n">Host</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">server</span><span class="o">&gt;</span>
<span class="n">X</span><span class="o">-</span><span class="n">Foo</span><span class="o">-</span><span class="n">first</span><span class="p">:</span> <span class="n">hi</span>
<span class="n">X</span><span class="o">-</span><span class="n">Foo</span><span class="o">-</span><span class="n">second</span><span class="p">:</span> <span class="n">there</span>
</pre></div>
</div>
<p class="rubric">Disambiguation of <code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code></p>
<p>In order to differentiate <code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> from other headers, when
<code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> are used, no other <a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a> bindings can
start with the same prefix provided in <code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> trait. If
<code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> is set to an empty string, then no other members can be
bound to <code class="docutils literal notranslate"><span class="pre">headers</span></code>.</p>
</div>
<div class="section" id="httpquery-trait">
<span id="smithy-api-httpquery-trait"></span><span id="id8"></span><h2><a href="#httpquery-trait"><span class="section-number">11.7. </span><code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Binds an operation input structure member to a query string parameter.</dd>
<dt>Trait selector</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>structure &gt; member
:test(&gt; :test(string, number, boolean, timestamp),
      &gt; collection &gt; member &gt; :test(string, number, boolean, timestamp))
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> trait can be applied to <code class="docutils literal notranslate"><span class="pre">structure</span></code> members that
target a <code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">number</span></code>, <code class="docutils literal notranslate"><span class="pre">boolean</span></code>, or <code class="docutils literal notranslate"><span class="pre">timestamp</span></code>; or a
<code class="docutils literal notranslate"><span class="pre">list</span></code>/<code class="docutils literal notranslate"><span class="pre">set</span></code> of these types.</p>
</dd>
<dt>Value type</dt><dd>A non-empty <code class="docutils literal notranslate"><span class="pre">string</span></code> value that defines the name of the query string
parameter. The query string parameter name MUST be case-sensitively unique
across all other members marked with the <code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> trait.</dd>
<dt>Conflicts with</dt><dd><a class="reference internal" href="#httplabel-trait"><span class="std std-ref">httpLabel trait</span></a>, <a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>, <a class="reference internal" href="#httpqueryparams-trait"><span class="std std-ref">httpQueryParams trait</span></a>,
<a class="reference internal" href="#httpprefixheaders-trait"><span class="std std-ref">httpPrefixHeaders trait</span></a>, <a class="reference internal" href="#httppayload-trait"><span class="std std-ref">httpPayload trait</span></a>,
<a class="reference internal" href="#httpresponsecode-trait"><span class="std std-ref">httpResponseCode trait</span></a></dd>
</dl>
<p>The following example defines an operation that optionally sends the
<code class="docutils literal notranslate"><span class="pre">color</span></code>, <code class="docutils literal notranslate"><span class="pre">shape</span></code>, and <code class="docutils literal notranslate"><span class="pre">size</span></code> query string parameters in an HTTP
request:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@readonly</span><span class="w"></span>
<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/things&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> ListThings</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">ListThingsInput</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">output:</span><span class="w"> </span><span class="vc">ListThingsOutput</span><span class="p">,</span><span class="w"> </span><span class="c">// omitted for brevity</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> ListThingsInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@httpQuery</span>(<span class="s2">&quot;color&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">color:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@httpQuery</span>(<span class="s2">&quot;shape&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">shape:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@httpQuery</span>(<span class="s2">&quot;size&quot;</span>)<span class="w"></span>
<span class="w">    </span><span class="nl">size:</span><span class="w"> </span><span class="vc">Integer</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p class="rubric">Serialization rules</p>
<ul class="simple">
<li>&quot;&amp;&quot; is used to separate query string parameter key-value pairs.</li>
<li>&quot;=&quot; is used to separate query string parameter names from values.</li>
<li>Reserved characters in keys and values as defined in <span class="target" id="index-6"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc3986.html#section-2.2"><strong>section 2.2 of RFC3986</strong></a> and <cite>%</cite>
MUST be <a class="reference external" href="https://tools.ietf.org/html/rfc3986#section-2.1">percent-encoded</a> (that is, <code class="docutils literal notranslate"><span class="pre">:/?#[]&#64;!$&amp;'()*+,;=%</span></code>).</li>
<li><code class="docutils literal notranslate"><span class="pre">boolean</span></code> values are serialized as <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> values are serialized as an <span class="target" id="index-7"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc3339.html"><strong>RFC 3339</strong></a>
<code class="docutils literal notranslate"><span class="pre">date-time</span></code> string by default (for example, <code class="docutils literal notranslate"><span class="pre">1985-04-12T23:20:50.52Z</span></code>,
and with percent-encoding, <code class="docutils literal notranslate"><span class="pre">1985-04-12T23%3A20%3A50.52Z</span></code>). The
<a class="reference internal" href="protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat trait</span></a> MAY be used to use a custom serialization
format.</li>
<li><a class="reference internal" href="model.html#list"><span class="std std-ref">List</span></a> and <a class="reference internal" href="model.html#set"><span class="std std-ref">set</span></a> members are serialized by adding multiple
query string parameters to the query string using the same name. For
example, given a member bound to <code class="docutils literal notranslate"><span class="pre">foo</span></code> that targets a list of strings
with a value of <code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;b&quot;]</span></code>, the value is serialized in the query string
as <code class="docutils literal notranslate"><span class="pre">foo=a&amp;foo=b</span></code>.</li>
<li>When deserializing, server implementations SHOULD use the first encountered
value in the query string for non-collection members. For example, given a
member bound to <code class="docutils literal notranslate"><span class="pre">foo</span></code> that targets a string and a query string of
<code class="docutils literal notranslate"><span class="pre">foo=a&amp;foo=b</span></code>, the deserialized value of <code class="docutils literal notranslate"><span class="pre">foo</span></code> should be <code class="docutils literal notranslate"><span class="pre">a</span></code>.</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>Percent-encoding is an implementation detail</p>
<p class="last">The encoding and serialization rules of shapes defined in a Smithy model are
implementation details. When designing clients, servers, and other kinds of
software based on Smithy models, the format in which the value of a member
is serialized SHOULD NOT be a concern of the end-user. As such, members bound
to the query string MUST be automatically percent-encoded when serializing
HTTP requests and automatically percent-decoded when deserializing HTTP
requests.</p>
</div>
<p class="rubric"><code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> is only used on input</p>
<p><code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> is ignored when resolving the HTTP bindings of an operation's
output or an error. This means that if a structure that contains members
marked with the <code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> trait is used as the top-level output structure
of an operation, then those members are sent as part of the
<a class="reference internal" href="#http-protocol-document-payloads"><span class="std std-ref">protocol-specific document</span></a> sent in
the body of the response.</p>
<p class="rubric">Do not put too much data in the query string</p>
<p>While there is no limit placed on the length of an <a class="reference external" href="https://tools.ietf.org/html/rfc7230.html#section-3.1.1">HTTP request line</a>,
many HTTP client and server implementations enforce limits in practice.
Carefully consider the maximum allowed length of each member that is bound to
an HTTP query string or path.</p>
</div>
<div class="section" id="httpqueryparams-trait">
<span id="smithy-api-httpqueryparams-trait"></span><span id="id9"></span><h2><a href="#httpqueryparams-trait"><span class="section-number">11.8. </span><code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Binds a map of key-value pairs to query string parameters.</dd>
<dt>Trait selector</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>structure &gt; member
:test(&gt; map &gt; member[id|member=value] &gt; :test(string, collection &gt; member &gt; string))
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> trait can be applied to <code class="docutils literal notranslate"><span class="pre">structure</span></code> members
that target a <code class="docutils literal notranslate"><span class="pre">map</span></code> of <code class="docutils literal notranslate"><span class="pre">string</span></code>, or a <code class="docutils literal notranslate"><span class="pre">map</span></code> of <code class="docutils literal notranslate"><span class="pre">list</span></code>/<code class="docutils literal notranslate"><span class="pre">set</span></code> of
<code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
</dd>
<dt>Value type</dt><dd>Annotation trait.</dd>
<dt>Conflicts with</dt><dd><a class="reference internal" href="#httplabel-trait"><span class="std std-ref">httpLabel trait</span></a>, <a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>, <a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>,
<a class="reference internal" href="#httpprefixheaders-trait"><span class="std std-ref">httpPrefixHeaders trait</span></a>, <a class="reference internal" href="#httppayload-trait"><span class="std std-ref">httpPayload trait</span></a>,
<a class="reference internal" href="#httpresponsecode-trait"><span class="std std-ref">httpResponseCode trait</span></a></dd>
<dt>Structurally exclusive</dt><dd>Only a single structure member can be bound to <code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code>.</dd>
</dl>
<p>The following example defines an operation that optionally sends the
target input map as query string parameters in an HTTP request:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@readonly</span><span class="w"></span>
<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/things&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> ListThings</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">ListThingsInput</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">output:</span><span class="w"> </span><span class="vc">ListThingsOutput</span><span class="p">,</span><span class="w"> </span><span class="c">// omitted for brevity</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> ListThingsInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@httpQueryParams</span>()<span class="w"></span>
<span class="w">    </span><span class="nl">myParams:</span><span class="w"> </span><span class="vc">MapOfStrings</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">map</span><span class="nc"> MapOfStrings</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">key:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">value:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p class="rubric"><code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> is only used on input</p>
<p><code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> is ignored when resolving the HTTP bindings of an operation's
output or an error. This means that if a structure that contains members
marked with the <code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> trait is used as the top-level output structure
of an operation, then those members are sent as part of the
<a class="reference internal" href="#http-protocol-document-payloads"><span class="std std-ref">protocol-specific document</span></a> sent in
the body of the response.</p>
<p class="rubric">Serialization rules</p>
<p>See the <a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a> serialization rules that define how the keys and values of the
target map will be serialized in the request query string. Key-value pairs in the target map
are treated like they were explicitly bound using the <a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>, including the
requirement that reserved characters MUST be <a class="reference external" href="https://tools.ietf.org/html/rfc3986#section-2.1">percent-encoded</a>.</p>
<p>When servers deserialize the query string into a <code class="docutils literal notranslate"><span class="pre">map</span></code> of <code class="docutils literal notranslate"><span class="pre">string</span></code>, they SHOULD take the
first encountered value for each key. Since this rule applies to all future query string
values, and changing from a <code class="docutils literal notranslate"><span class="pre">map</span></code> of <code class="docutils literal notranslate"><span class="pre">string</span></code> to a <code class="docutils literal notranslate"><span class="pre">map</span></code> of <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">string</span></code> is
backwards-incompatible, care should be taken to use <code class="docutils literal notranslate"><span class="pre">map</span></code> of <code class="docutils literal notranslate"><span class="pre">string</span></code> only when it is
certain that multiple values for any query string will never be meaningful for the operation.</p>
<p>If a member with the <code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> trait and a member with the <a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>
conflict, clients MUST use the value set by the member with the <a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a> and
disregard the value set by <code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code>. For example, given the following model:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/things&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> PutThing</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">PutThingInput</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> PutThingInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@httpQuery</span><span class="w"></span>
<span class="w">    </span><span class="nd">@required</span><span class="w"></span>
<span class="w">    </span><span class="nl">thingId:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>

<span class="w">    </span><span class="nd">@httpQueryParams</span><span class="w"></span>
<span class="w">    </span><span class="nl">tags:</span><span class="w"> </span><span class="vc">MapOfStrings</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">map</span><span class="nc"> MapOfStrings</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">key:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">value:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p>And given the following input to <code class="docutils literal notranslate"><span class="pre">PutThing</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;thingId&quot;</span><span class="p">:</span> <span class="s2">&quot;realId&quot;</span><span class="p">,</span>
    <span class="nt">&quot;tags&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;thingId&quot;</span><span class="p">:</span> <span class="s2">&quot;fakeId&quot;</span><span class="p">,</span>
        <span class="nt">&quot;otherTag&quot;</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An example HTTP request would be serialized as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST /things?thingId=realId&amp;otherTag=value
Host: &lt;server&gt;
</pre></div>
</div>
<p>When deserializing HTTP request query string parameters into members with the
<code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> trait, servers MUST treat all values as strings and produce
empty string values for keys which do not have values specified. For example,
given the following model:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-U21pdGh5" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U21pdGh5" name="U21pdGh5" role="tab" tabindex="0">Smithy</button></div><div aria-labelledby="tab-0-U21pdGh5" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-U21pdGh5" name="U21pdGh5" role="tabpanel" tabindex="0"><div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/things&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> PostThing</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">PostThingInput</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">structure</span><span class="nc"> PostThingInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@httpQueryParams</span><span class="w"></span>
<span class="w">    </span><span class="nl">tags:</span><span class="w"> </span><span class="vc">MapOfStrings</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">map</span><span class="nc"> MapOfStrings</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">key:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nl">value:</span><span class="w"> </span><span class="vc">String</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div></div>
<p>And the following HTTP request:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>POST /things?thingId=realId&amp;otherTag=true&amp;anotherTag&amp;lastTag=
</pre></div>
</div>
<p>A server should deserialize the following input structure:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;tags&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;thingId&quot;</span><span class="p">:</span> <span class="s2">&quot;realId&quot;</span><span class="p">,</span>
        <span class="nt">&quot;otherTag&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
        <span class="nt">&quot;anotherTag&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;lastTag&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="httpresponsecode-trait">
<span id="smithy-api-httpresponsecode-trait"></span><span id="id10"></span><h2><a href="#httpresponsecode-trait"><span class="section-number">11.9. </span><code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Binds a structure member to the HTTP response status code so that an
HTTP response status code can be set dynamically at runtime to something
other than <code class="docutils literal notranslate"><span class="pre">code</span></code> of the <a class="reference internal" href="#http-trait"><span class="std std-ref">http trait</span></a>.</dd>
<dt>Trait selector</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>structure &gt; member :test(&gt; integer)
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> trait can be applied to <code class="docutils literal notranslate"><span class="pre">structure</span></code> members
that target an <code class="docutils literal notranslate"><span class="pre">integer</span></code>.</p>
</dd>
<dt>Value type</dt><dd>Annotation trait.</dd>
<dt>Conflicts with</dt><dd><a class="reference internal" href="#httplabel-trait"><span class="std std-ref">httpLabel trait</span></a>, <a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>,
<a class="reference internal" href="#httpprefixheaders-trait"><span class="std std-ref">httpPrefixHeaders trait</span></a>, <a class="reference internal" href="#httppayload-trait"><span class="std std-ref">httpPayload trait</span></a>,
<a class="reference internal" href="#httpquery-trait"><span class="std std-ref">httpQuery trait</span></a>, <a class="reference internal" href="#httpqueryparams-trait"><span class="std std-ref">httpQueryParams trait</span></a>,</dd>
</dl>
<p class="rubric"><code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> use cases</p>
<p>Marking an output <code class="docutils literal notranslate"><span class="pre">structure</span></code> member with this trait can be used to provide
different response codes for an operation, like a 200 or 201 for a PUT
operation. If this member isn't provided, server implementations MUST default
to the <cite>code</cite> set by the <a class="reference internal" href="#http-trait"><span class="std std-ref">http trait</span></a>.</p>
<p class="rubric"><code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> is only used on output</p>
<p><code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> is ignored when resolving the HTTP bindings of an
operation's input structure. This means that if a structure that contains
members marked with the <code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> trait is used as the top-level
input structure of an operation, then those members are sent as part of the
<a class="reference internal" href="#http-protocol-document-payloads"><span class="std std-ref">protocol-specific document</span></a> sent in
the body of the request.</p>
</div>
<div class="section" id="cors-trait">
<span id="smithy-api-cors-trait"></span><span id="id11"></span><h2><a href="#cors-trait"><span class="section-number">11.10. </span><code class="docutils literal notranslate"><span class="pre">cors</span></code> trait</a></h2>
<dl class="docutils">
<dt>Summary</dt><dd>Defines how a service supports cross-origin resource sharing</dd>
<dt>Trait selector</dt><dd><code class="docutils literal notranslate"><span class="pre">service</span></code></dd>
<dt>Value type</dt><dd><code class="docutils literal notranslate"><span class="pre">structure</span></code></dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">cors</span></code> trait is a structure that supports the following members:</p>
<table border="1" class="colwidths-given docutils align-default">
<colgroup>
<col width="10%" />
<col width="25%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>origin</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The origin from which browser script-originating requests will be
allowed. Defaults to <code class="docutils literal notranslate"><span class="pre">*</span></code>.</td>
</tr>
<tr class="row-odd"><td>maxAge</td>
<td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>The maximum number of seconds for which browsers are allowed to cache
the results of a preflight <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code> request. Defaults to <code class="docutils literal notranslate"><span class="pre">600</span></code>, the
maximum age permitted by several browsers. Set to <code class="docutils literal notranslate"><span class="pre">-1</span></code> to disable
caching entirely.</td>
</tr>
<tr class="row-even"><td>additionalAllowedHeaders</td>
<td><code class="docutils literal notranslate"><span class="pre">list&lt;string&gt;</span></code></td>
<td>The names of headers that should be included in the
<code class="docutils literal notranslate"><span class="pre">Access-Control-Allow-Headers</span></code> header in responses to preflight
<code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code> requests. This list will be used in addition to the names of
all request headers bound to an input data member via the
<a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>, as well as any headers required by the protocol
or authentication scheme.</td>
</tr>
<tr class="row-odd"><td>additionalExposedHeaders</td>
<td><code class="docutils literal notranslate"><span class="pre">list&lt;string&gt;</span></code></td>
<td>The names of headers that should be included in the
<code class="docutils literal notranslate"><span class="pre">Access-Control-Expose-Headers</span></code> header in all responses sent by the
service. This list will be used in addition to the names of all request
headers bound to an output data member via the <a class="reference internal" href="#httpheader-trait"><span class="std std-ref">httpHeader trait</span></a>,
as well as any headers required by the protocol or authentication
scheme.</td>
</tr>
</tbody>
</table>
<p>Adding a <code class="docutils literal notranslate"><span class="pre">cors</span></code> trait with its value set to an empty object enables
cross-origin resource sharing for all origins and allows browser scripts access
to all headers to which data is bound in the model, as well as any headers used
by the protocol and authentication scheme.</p>
<p>The default settings are not compatible with certain authentication schemes
(e.g., <code class="docutils literal notranslate"><span class="pre">http-basic</span></code>) that rely on browser-managed credentials. Services using
such authentication schemes MUST designate a single origin from which
cross-origin, credentialed requests will be accepted.</p>
</div>
<div class="section" id="serializing-http-messages">
<h2><a href="#serializing-http-messages"><span class="section-number">11.11. </span>Serializing HTTP messages</a></h2>
<p>The following steps are taken to serialize an HTTP request given a map of
parameters:</p>
<ol class="arabic simple">
<li>Set the HTTP method to the <code class="docutils literal notranslate"><span class="pre">method</span></code> property of the <a class="reference internal" href="#http-trait"><span class="std std-ref">http trait</span></a>
of the operation.</li>
<li>Set the URI of the HTTP request to the <code class="docutils literal notranslate"><span class="pre">uri</span></code> property of the <code class="docutils literal notranslate"><span class="pre">http</span></code>
trait.</li>
<li>Iterate over all of the key-value pairs of the parameters and find the
corresponding structure member by name:<ol class="arabic">
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait, expand the value into the URI.</li>
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> trait, serialize the value into the
HTTP request as a query string parameter.</li>
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> trait, serialize the values into
the HTTP request as query string parameters.</li>
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> trait, serialize the value in an
HTTP header using the value of the <code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> trait.</li>
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> trait and the value is a map,
serialize the map key value pairs as prefixed HTTP headers.</li>
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait, serialize the value as the
body of the request.</li>
<li>If the member has no bindings, serialize the key-value pair as part of a
protocol-specific document sent in the body of the request.</li>
</ol>
</li>
</ol>
<p>The following steps are taken to serialize an HTTP response given a map of
parameters:</p>
<ol class="arabic simple">
<li>If serializing the output of an operation, set the status code of the
response to the <code class="docutils literal notranslate"><span class="pre">code</span></code> property of the <a class="reference internal" href="#http-trait"><span class="std std-ref">http trait</span></a>.</li>
<li>If serializing an error and the <a class="reference internal" href="#httperror-trait"><span class="std std-ref">httpError trait</span></a> is present,
set the status code of the response to its value. Otherwise, set the status
code to 400 if the error trait is &quot;client&quot; or to 500 if the error trait is
&quot;server&quot;.</li>
<li>Iterate over all of the key-value pairs of the parameters and find the
corresponding structure member by name:<ol class="arabic">
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> trait, serialize the value in an
HTTP header using the value of the <code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> trait.</li>
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> trait and the value is a map,
serialize the map key value pairs as prefixed HTTP headers.</li>
<li>If the member has the <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait, serialize the value as the
body of the response.</li>
<li>If the member has no bindings, serialize the key-value pair as part of a
protocol-specific document sent in the body of the response.</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="event-streams">
<h2><a href="#event-streams"><span class="section-number">11.12. </span>Event streams</a></h2>
<p>When using <a class="reference internal" href="stream-traits.html#event-streams"><span class="std std-ref">event streams</span></a> and HTTP bindings, the
<a class="reference internal" href="#httppayload-trait"><span class="std std-ref">httpPayload</span></a> trait MUST be applied to any input or
output member that targets a shape marked with the <a class="reference internal" href="stream-traits.html#streaming-trait"><span class="std std-ref">streaming trait</span></a>.</p>
<p>The following example defines an operation that uses an input event stream
and HTTP bindings:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/messages&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> PublishMessages</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">PublishMessagesInput</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> PublishMessagesInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nd">@httpPayload</span><span class="w"></span>
<span class="w">    </span><span class="nl">messages:</span><span class="w"> </span><span class="vc">MessageStream</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@streaming</span><span class="w"></span>
<span class="kd">union</span><span class="nc"> MessageStream</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">message:</span><span class="w"> </span><span class="vc">Message</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">structure</span><span class="nc"> Message</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">message:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
<p>The following is <strong>invalid</strong> because the operation has the <code class="docutils literal notranslate"><span class="pre">http</span></code> trait
and an input member is marked with the <code class="docutils literal notranslate"><span class="pre">streaming</span></code> trait but not
marked with the <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">namespace</span><span class="nc"> smithy.example</span><span class="w"></span>

<span class="nd">@http</span>(<span class="nl">method:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">uri:</span><span class="w"> </span><span class="s2">&quot;/messages&quot;</span>)<span class="w"></span>
<span class="kd">operation</span><span class="nc"> InvalidOperation</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">input:</span><span class="w"> </span><span class="vc">InvalidOperationInput</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@input</span><span class="w"></span>
<span class="kd">structure</span><span class="nc"> InvalidOperationInput</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">invalid:</span><span class="w"> </span><span class="vc">MessageStream</span><span class="p">,</span><span class="w"> </span><span class="c">// &lt;-- Missing the @httpPayload trait</span><span class="w"></span>
}<span class="w"></span>

<span class="nd">@streaming</span><span class="w"></span>
<span class="kd">union</span><span class="nc"> MessageStream</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">message:</span><span class="w"> </span><span class="vc">Message</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>

<span class="kd">structure</span><span class="nc"> Message</span><span class="w"> </span>{<span class="w"></span>
<span class="w">    </span><span class="nl">message:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span><span class="w"></span>
}<span class="w"></span>
</pre></div>
</div>
</div>
</div>


                    
                    <section class="relations">
                        
                        <a href="stream-traits.html" title="previous chapter" class="previous-page clearfix hidden-xs">‚Üê <span class="section-number">10. </span>Streaming Traits</a>
                        
                        <a href="xml-traits.html" title="next chapter" class="next-page clearfix"><span class="section-number">12. </span>XML binding traits ‚Üí</a>
                    </section>
                    
                </article><aside id="right-column" class="side-column hidden-sm">
                    <div class="column-body">
                        <section class="sidebar">
                            
                            <section class="next-previous">
                                
                                <a href="stream-traits.html" title="previous chapter" class="previous-page clearfix hidden-xs">‚Üê Prev</a>
                                
                                <a href="xml-traits.html" title="next chapter" class="next-page clearfix">Next ‚Üí</a>
                            </section>
                            
                            <ul>
<li><a class="reference internal" href="#">11. HTTP binding traits</a><ul>
<li><a class="reference internal" href="#http-trait">11.1. <code class="docutils literal notranslate"><span class="pre">http</span></code> trait</a><ul>
<li><a class="reference internal" href="#method">11.1.1. method</a></li>
<li><a class="reference internal" href="#uri">11.1.2. uri</a><ul>
<li><a class="reference internal" href="#literal-character-sequences">11.1.2.1. Literal character sequences</a></li>
<li><a class="reference internal" href="#labels">11.1.2.2. Labels</a></li>
<li><a class="reference internal" href="#query-string-literals">11.1.2.3. Query string literals</a></li>
<li><a class="reference internal" href="#greedy-labels">11.1.2.4. Greedy labels</a></li>
<li><a class="reference internal" href="#pattern-validation-and-conflict-avoidance">11.1.2.5. Pattern Validation and Conflict Avoidance</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#httperror-trait">11.2. <code class="docutils literal notranslate"><span class="pre">httpError</span></code> trait</a></li>
<li><a class="reference internal" href="#httpheader-trait">11.3. <code class="docutils literal notranslate"><span class="pre">httpHeader</span></code> trait</a><ul>
<li><a class="reference internal" href="#restricted-http-headers">11.3.1. Restricted HTTP headers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#httplabel-trait">11.4. <code class="docutils literal notranslate"><span class="pre">httpLabel</span></code> trait</a></li>
<li><a class="reference internal" href="#httppayload-trait">11.5. <code class="docutils literal notranslate"><span class="pre">httpPayload</span></code> trait</a></li>
<li><a class="reference internal" href="#httpprefixheaders-trait">11.6. <code class="docutils literal notranslate"><span class="pre">httpPrefixHeaders</span></code> trait</a></li>
<li><a class="reference internal" href="#httpquery-trait">11.7. <code class="docutils literal notranslate"><span class="pre">httpQuery</span></code> trait</a></li>
<li><a class="reference internal" href="#httpqueryparams-trait">11.8. <code class="docutils literal notranslate"><span class="pre">httpQueryParams</span></code> trait</a></li>
<li><a class="reference internal" href="#httpresponsecode-trait">11.9. <code class="docutils literal notranslate"><span class="pre">httpResponseCode</span></code> trait</a></li>
<li><a class="reference internal" href="#cors-trait">11.10. <code class="docutils literal notranslate"><span class="pre">cors</span></code> trait</a></li>
<li><a class="reference internal" href="#serializing-http-messages">11.11. Serializing HTTP messages</a></li>
<li><a class="reference internal" href="#event-streams">11.12. Event streams</a></li>
</ul>
</li>
</ul>

                        </section>
                    </div>
                </aside></div>
        </section>
        
    
<footer id="footer">
    <div class="width-wrapper">
        <div class="copyright">
            <p>¬©2021, Amazon Web Services, Inc or its affiliates. All rights reserved.</p>
        </div>
    </div>
</footer>
  </body>
</html>